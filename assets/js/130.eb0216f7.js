(window.webpackJsonp=window.webpackJsonp||[]).push([[130],{872:function(t,s,a){"use strict";a.r(s);a(283);var n={mounted:function(){var t=-1!==location.href.indexOf("FE-Interview-Questions")?"59154049":"66575297",s=document.createElement("script");s.type="text/javascript",s.charset="UTF-8",s.src="http://tajs.qq.com/stats?sId=".concat(t),document.body.appendChild(s)}},e=a(38),p=Object(e.a)(n,(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"ä¸€ã€vue-js-è¿è¡Œæœºåˆ¶å…¨å±€æ¦‚è§ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€vue-js-è¿è¡Œæœºåˆ¶å…¨å±€æ¦‚è§ˆ"}},[t._v("#")]),t._v(" ä¸€ã€Vue.js è¿è¡Œæœºåˆ¶å…¨å±€æ¦‚è§ˆ")]),t._v(" "),a("h3",{attrs:{id:"å…¨å±€æ¦‚è§ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…¨å±€æ¦‚è§ˆ"}},[t._v("#")]),t._v(" å…¨å±€æ¦‚è§ˆ")]),t._v(" "),a("p",[t._v("è¿™ä¸€èŠ‚ç¬”è€…å°†ä¸ºå¤§å®¶ä»‹ç»ä¸€ä¸‹ Vue.js å†…éƒ¨çš„æ•´ä¸ªæµç¨‹ï¼Œå¸Œæœ›èƒ½è®©å¤§å®¶å¯¹å…¨å±€æœ‰ä¸€ä¸ªæ•´ä½“çš„å°è±¡ï¼Œç„¶åæˆ‘ä»¬å†æ¥é€ä¸ªæ¨¡å—è¿›è¡Œè®²è§£ã€‚ä»æ¥æ²¡æœ‰äº†è§£è¿‡ Vue.js å®ç°çš„åŒå­¦å¯èƒ½ä¼šå¯¹ä¸€äº›å†…å®¹æ„Ÿåˆ°ç–‘æƒ‘ï¼Œè¿™æ˜¯å¾ˆæ­£å¸¸çš„ï¼Œè¿™ä¸€èŠ‚çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†è®©å¤§å®¶å¯¹æ•´ä¸ªæµç¨‹æœ‰ä¸€ä¸ªå¤§æ¦‚çš„è®¤è¯†ï¼Œç®—æ˜¯ä¸€ä¸ªæ¦‚è§ˆé¢„å¤‡çš„è¿‡ç¨‹")]),t._v(" "),a("p",[t._v("é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç¬”è€…ç”»çš„å†…éƒ¨æµç¨‹å›¾ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/1.png",alt:""}})]),t._v(" "),a("p",[t._v("å¤§å®¶ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªå›¾ä¸€å®šæ˜¯ä¸€å¤´é›¾æ°´çš„ï¼Œæ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬æ¥é€ä¸ªè®²ä¸€ä¸‹è¿™äº›æ¨¡å—çš„ä½œç”¨ä»¥åŠè°ƒç”¨å…³ç³»ã€‚ç›¸ä¿¡è®²å®Œä¹‹åå¤§å®¶å¯¹Vue.jså†…éƒ¨è¿è¡Œæœºåˆ¶ä¼šæœ‰ä¸€ä¸ªå¤§æ¦‚çš„è®¤è¯†ã€‚")]),t._v(" "),a("h3",{attrs:{id:"åˆå§‹åŒ–åŠæŒ‚è½½"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–åŠæŒ‚è½½"}},[t._v("#")]),t._v(" åˆå§‹åŒ–åŠæŒ‚è½½")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/2.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("åœ¨ "),a("code",[t._v("new Vue()")]),t._v(" ä¹‹åã€‚ Vue ä¼šè°ƒç”¨ "),a("code",[t._v("_init")]),t._v(" å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„ "),a("code",[t._v("init")]),t._v(" è¿‡ç¨‹ï¼Œå®ƒä¼šåˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸã€äº‹ä»¶ã€ propsã€ methodsã€ dataã€ computed ä¸ watch ç­‰ã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯é€šè¿‡ "),a("code",[t._v("Object.defineProperty")]),t._v(" è®¾ç½® "),a("code",[t._v("setter")]),t._v(" ä¸ "),a("code",[t._v("getter")]),t._v(" å‡½æ•°ï¼Œç”¨æ¥å®ç°ã€Œ"),a("strong",[t._v("å“åº”å¼")]),t._v("ã€ä»¥åŠã€Œ"),a("strong",[t._v("ä¾èµ–æ”¶é›†")]),t._v("ã€ï¼Œåé¢ä¼šè¯¦ç»†è®²åˆ°ï¼Œè¿™é‡Œåªè¦æœ‰ä¸€ä¸ªå°è±¡å³å¯ã€‚")])]),t._v(" "),a("blockquote",[a("p",[t._v("åˆå§‹åŒ–ä¹‹åè°ƒç”¨ "),a("code",[t._v("$mount")]),t._v(" ä¼šæŒ‚è½½ç»„ä»¶ï¼Œå¦‚æœæ˜¯è¿è¡Œæ—¶ç¼–è¯‘ï¼Œå³ä¸å­˜åœ¨ render function ä½†æ˜¯å­˜åœ¨ template çš„æƒ…å†µï¼Œéœ€è¦è¿›è¡Œã€Œ"),a("strong",[t._v("ç¼–è¯‘")]),t._v("ã€æ­¥éª¤ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"ç¼–è¯‘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–è¯‘"}},[t._v("#")]),t._v(" ç¼–è¯‘")]),t._v(" "),a("p",[t._v("compileç¼–è¯‘å¯ä»¥åˆ†æˆ "),a("code",[t._v("parse")]),t._v("ã€"),a("code",[t._v("optimize")]),t._v(" ä¸ "),a("code",[t._v("generate")]),t._v(" ä¸‰ä¸ªé˜¶æ®µï¼Œæœ€ç»ˆéœ€è¦å¾—åˆ° render functionã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/3.png",alt:""}})]),t._v(" "),a("p",[a("strong",[t._v("1. parse")])]),t._v(" "),a("p",[a("code",[t._v("parse")]),t._v(" ä¼šç”¨æ­£åˆ™ç­‰æ–¹å¼è§£æ template æ¨¡æ¿ä¸­çš„æŒ‡ä»¤ã€classã€styleç­‰æ•°æ®ï¼Œå½¢æˆASTã€‚")]),t._v(" "),a("p",[a("strong",[t._v("2. optimize")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("optimize")]),t._v(" çš„ä¸»è¦ä½œç”¨æ˜¯æ ‡è®° static é™æ€èŠ‚ç‚¹ï¼Œè¿™æ˜¯ Vue åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¸€å¤„ä¼˜åŒ–ï¼Œåé¢å½“ "),a("code",[t._v("update")]),t._v(" æ›´æ–°ç•Œé¢æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ª "),a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹ï¼Œ diff ç®—æ³•ä¼šç›´æ¥è·³è¿‡é™æ€èŠ‚ç‚¹ï¼Œä»è€Œå‡å°‘äº†æ¯”è¾ƒçš„è¿‡ç¨‹ï¼Œä¼˜åŒ–äº† "),a("code",[t._v("patch")]),t._v(" çš„æ€§èƒ½ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("3. generate")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("generate")]),t._v(" æ˜¯å°† AST è½¬åŒ–æˆ "),a("code",[t._v("render function")]),t._v("å­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œå¾—åˆ°ç»“æœæ˜¯ "),a("code",[t._v("render")]),t._v(" çš„å­—ç¬¦ä¸²ä»¥åŠ staticRenderFns å­—ç¬¦ä¸²ã€‚")])]),t._v(" "),a("ul",[a("li",[t._v("åœ¨ç»å†è¿‡ "),a("code",[t._v("parse")]),t._v("ã€"),a("code",[t._v("optimize")]),t._v(" ä¸ "),a("code",[t._v("generate")]),t._v(" è¿™ä¸‰ä¸ªé˜¶æ®µä»¥åï¼Œç»„ä»¶ä¸­å°±ä¼šå­˜åœ¨æ¸²æŸ“ "),a("code",[t._v("VNode")]),t._v(" æ‰€éœ€çš„ "),a("code",[t._v("render function")]),t._v(" äº†ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"å“åº”å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å“åº”å¼"}},[t._v("#")]),t._v(" å“åº”å¼")]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥ä¹Ÿå°±æ˜¯ Vue.js å“åº”å¼æ ¸å¿ƒéƒ¨åˆ†ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/4.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("è¿™é‡Œçš„ "),a("code",[t._v("getter")]),t._v(" è·Ÿ "),a("code",[t._v("setter")]),t._v(" å·²ç»åœ¨ä¹‹å‰ä»‹ç»è¿‡äº†ï¼Œåœ¨ "),a("code",[t._v("init")]),t._v(" çš„æ—¶å€™é€šè¿‡ "),a("code",[t._v("Object.defineProperty")]),t._v(" è¿›è¡Œäº†ç»‘å®šï¼Œå®ƒä½¿å¾—å½“è¢«è®¾ç½®çš„å¯¹è±¡è¢«è¯»å–çš„æ—¶å€™ä¼šæ‰§è¡Œ "),a("code",[t._v("getter")]),t._v(" å‡½æ•°ï¼Œè€Œåœ¨å½“è¢«èµ‹å€¼çš„æ—¶å€™ä¼šæ‰§è¡Œ "),a("code",[t._v("setter")]),t._v(" å‡½æ•°ã€‚")])]),t._v(" "),a("ul",[a("li",[t._v("å½“ "),a("code",[t._v("render function")]),t._v(" è¢«æ¸²æŸ“çš„æ—¶å€™ï¼Œå› ä¸ºä¼šè¯»å–æ‰€éœ€å¯¹è±¡çš„å€¼ï¼Œæ‰€ä»¥ä¼šè§¦å‘ "),a("code",[t._v("getter")]),t._v(" å‡½æ•°è¿›è¡Œã€Œ"),a("strong",[t._v("ä¾èµ–æ”¶é›†")]),t._v("ã€ï¼Œã€Œ"),a("strong",[t._v("ä¾èµ–æ”¶é›†")]),t._v("ã€çš„ç›®çš„æ˜¯å°†è§‚å¯Ÿè€… "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡å­˜æ”¾åˆ°å½“å‰é—­åŒ…ä¸­çš„è®¢é˜…è€… "),a("code",[t._v("Dep")]),t._v(" çš„ "),a("code",[t._v("subs")]),t._v(" ä¸­ã€‚å½¢æˆå¦‚ä¸‹æ‰€ç¤ºçš„è¿™æ ·ä¸€ä¸ªå…³ç³»ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/5.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("åœ¨ä¿®æ”¹å¯¹è±¡çš„å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº”çš„ "),a("code",[t._v("setter")]),t._v("ï¼Œ "),a("code",[t._v("setter")]),t._v(" é€šçŸ¥ä¹‹å‰ã€Œ"),a("strong",[t._v("ä¾èµ–æ”¶é›†")]),t._v("ã€å¾—åˆ°çš„ Dep ä¸­çš„æ¯ä¸€ä¸ª Watcherï¼Œå‘Šè¯‰å®ƒä»¬è‡ªå·±çš„å€¼æ”¹å˜äº†ï¼Œéœ€è¦é‡æ–°æ¸²æŸ“è§†å›¾ã€‚è¿™æ—¶å€™è¿™äº› Watcher å°±ä¼šå¼€å§‹è°ƒç”¨ "),a("code",[t._v("update")]),t._v(" æ¥æ›´æ–°è§†å›¾ï¼Œå½“ç„¶è¿™ä¸­é—´è¿˜æœ‰ä¸€ä¸ª "),a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹ä»¥åŠä½¿ç”¨é˜Ÿåˆ—æ¥å¼‚æ­¥æ›´æ–°çš„ç­–ç•¥ï¼Œè¿™ä¸ªæˆ‘ä»¬åé¢å†è®²ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"virtual-dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#virtual-dom"}},[t._v("#")]),t._v(" Virtual DOM")]),t._v(" "),a("blockquote",[a("p",[t._v("æˆ‘ä»¬çŸ¥é“ï¼Œ"),a("code",[t._v("render function")]),t._v(" ä¼šè¢«è½¬åŒ–æˆ "),a("code",[t._v("VNode")]),t._v(" èŠ‚ç‚¹ã€‚"),a("code",[t._v("Virtual DOM")]),t._v(" å…¶å®å°±æ˜¯ä¸€æ£µä»¥ JavaScript å¯¹è±¡ï¼ˆ VNode èŠ‚ç‚¹ï¼‰ä½œä¸ºåŸºç¡€çš„æ ‘ï¼Œç”¨å¯¹è±¡å±æ€§æ¥æè¿°èŠ‚ç‚¹ï¼Œå®é™…ä¸Šå®ƒåªæ˜¯ä¸€å±‚å¯¹çœŸå® DOM çš„æŠ½è±¡ã€‚æœ€ç»ˆå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—æ“ä½œä½¿è¿™æ£µæ ‘æ˜ å°„åˆ°çœŸå®ç¯å¢ƒä¸Šã€‚ç”±äº Virtual DOM æ˜¯ä»¥ JavaScript å¯¹è±¡ä¸ºåŸºç¡€è€Œä¸ä¾èµ–çœŸå®å¹³å°ç¯å¢ƒï¼Œæ‰€ä»¥ä½¿å®ƒå…·æœ‰äº†è·¨å¹³å°çš„èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´æµè§ˆå™¨å¹³å°ã€Weexã€Node ç­‰ã€‚")])]),t._v(" "),a("p",[t._v("æ¯”å¦‚è¯´ä¸‹é¢è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    tag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*è¯´æ˜è¿™æ˜¯ä¸€ä¸ªdivæ ‡ç­¾*/")]),t._v("\n    children"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*å­˜æ”¾è¯¥æ ‡ç­¾çš„å­èŠ‚ç‚¹*/")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            tag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*è¯´æ˜è¿™æ˜¯ä¸€ä¸ªaæ ‡ç­¾*/")]),t._v("\n            text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click me'")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*æ ‡ç­¾çš„å†…å®¹*/")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("æ¸²æŸ“åå¯ä»¥å¾—åˆ°")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("<div>\n    <a>click me</a>\n</div>\n\n")])])]),a("blockquote",[a("p",[t._v("è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå®é™…ä¸Šçš„èŠ‚ç‚¹æœ‰æ›´å¤šçš„å±æ€§æ¥æ ‡å¿—èŠ‚ç‚¹ï¼Œæ¯”å¦‚ isStatic ï¼ˆä»£è¡¨æ˜¯å¦ä¸ºé™æ€èŠ‚ç‚¹ï¼‰ã€ isComment ï¼ˆä»£è¡¨æ˜¯å¦ä¸ºæ³¨é‡ŠèŠ‚ç‚¹ï¼‰ç­‰ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"æ›´æ–°è§†å›¾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ›´æ–°è§†å›¾"}},[t._v("#")]),t._v(" æ›´æ–°è§†å›¾")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/6.png",alt:""}})]),t._v(" "),a("ul",[a("li",[t._v("å‰é¢æˆ‘ä»¬è¯´åˆ°ï¼Œåœ¨ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡å€¼çš„æ—¶å€™ï¼Œä¼šé€šè¿‡ "),a("code",[t._v("setter -> Watcher -> update")]),t._v(" çš„æµç¨‹æ¥ä¿®æ”¹å¯¹åº”çš„è§†å›¾ï¼Œé‚£ä¹ˆæœ€ç»ˆæ˜¯å¦‚ä½•æ›´æ–°è§†å›¾çš„å‘¢ï¼Ÿ")]),t._v(" "),a("li",[t._v("å½“æ•°æ®å˜åŒ–åï¼Œæ‰§è¡Œ render function å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°çš„ VNode èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦å¾—åˆ°æ–°çš„è§†å›¾ï¼Œæœ€ç®€å•ç²—æš´çš„æ–¹æ³•å°±æ˜¯ç›´æ¥è§£æè¿™ä¸ªæ–°çš„ VNode èŠ‚ç‚¹ï¼Œç„¶åç”¨ "),a("code",[t._v("innerHTML")]),t._v(" ç›´æ¥å…¨éƒ¨æ¸²æŸ“åˆ°çœŸå® DOM ä¸­ã€‚ä½†æ˜¯å…¶å®æˆ‘ä»¬åªå¯¹å…¶ä¸­çš„ä¸€å°å—å†…å®¹è¿›è¡Œäº†ä¿®æ”¹ï¼Œè¿™æ ·åšä¼¼ä¹æœ‰äº›ã€Œ"),a("strong",[t._v("æµªè´¹")]),t._v("ã€ã€‚")]),t._v(" "),a("li",[t._v("é‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸èƒ½åªä¿®æ”¹é‚£äº›ã€Œæ”¹å˜äº†çš„åœ°æ–¹ã€å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦ä»‹ç»æˆ‘ä»¬çš„ã€Œ"),a("strong",[a("code",[t._v("patch")])]),t._v("ã€äº†ã€‚æˆ‘ä»¬ä¼šå°†æ–°çš„ VNode ä¸æ—§çš„ VNode ä¸€èµ·ä¼ å…¥ "),a("code",[t._v("patch")]),t._v(" è¿›è¡Œæ¯”è¾ƒï¼Œç»è¿‡ diff ç®—æ³•å¾—å‡ºå®ƒä»¬çš„ã€Œ"),a("strong",[t._v("å·®å¼‚")]),t._v("ã€ã€‚æœ€åæˆ‘ä»¬åªéœ€è¦å°†è¿™äº›ã€Œ"),a("strong",[t._v("å·®å¼‚")]),t._v("ã€çš„å¯¹åº” DOM è¿›è¡Œä¿®æ”¹å³å¯ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"å†çœ‹å…¨å±€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å†çœ‹å…¨å±€"}},[t._v("#")]),t._v(" å†çœ‹å…¨å±€")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/7.png",alt:""}})]),t._v(" "),a("p",[t._v("å›è¿‡å¤´å†æ¥çœ‹çœ‹è¿™å¼ å›¾ï¼Œæ˜¯ä¸æ˜¯å¤§è„‘ä¸­å·²ç»æœ‰ä¸€ä¸ªå¤§æ¦‚çš„è„‰ç»œäº†å‘¢ï¼Ÿ")]),t._v(" "),a("p",[a("strong",[t._v("é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬ç»§ç»­å­¦ä¹ æ¯ä¸€ä¸ªæ¨¡å—å§!")])]),t._v(" "),a("h2",{attrs:{id:"äºŒã€å“åº”å¼ç³»ç»Ÿçš„åŸºæœ¬åŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€å“åº”å¼ç³»ç»Ÿçš„åŸºæœ¬åŸç†"}},[t._v("#")]),t._v(" äºŒã€å“åº”å¼ç³»ç»Ÿçš„åŸºæœ¬åŸç†")]),t._v(" "),a("h3",{attrs:{id:"å“åº”å¼ç³»ç»Ÿ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å“åº”å¼ç³»ç»Ÿ"}},[t._v("#")]),t._v(" å“åº”å¼ç³»ç»Ÿ")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("Vue.js")]),t._v(" æ˜¯ä¸€æ¬¾ MVVM æ¡†æ¶ï¼Œæ•°æ®æ¨¡å‹ä»…ä»…æ˜¯æ™®é€šçš„ JavaScript å¯¹è±¡ï¼Œä½†æ˜¯å¯¹è¿™äº›å¯¹è±¡è¿›è¡Œæ“ä½œæ—¶ï¼Œå´èƒ½å½±å“å¯¹åº”è§†å›¾ï¼Œå®ƒçš„æ ¸å¿ƒå®ç°å°±æ˜¯ã€Œ"),a("strong",[t._v("å“åº”å¼ç³»ç»Ÿ")]),t._v("ã€ã€‚å°½ç®¡æˆ‘ä»¬åœ¨ä½¿ç”¨ Vue.js è¿›è¡Œå¼€å‘æ—¶ä¸ä¼šç›´æ¥ä¿®æ”¹ã€Œ"),a("strong",[t._v("å“åº”å¼ç³»ç»Ÿ")]),t._v("ã€ï¼Œä½†æ˜¯ç†è§£å®ƒçš„å®ç°æœ‰åŠ©äºé¿å¼€ä¸€äº›å¸¸è§çš„ã€Œ"),a("strong",[t._v("å‘")]),t._v("ã€ï¼Œä¹Ÿæœ‰åŠ©äºåœ¨é‡è§ä¸€äº›ç¢ç£¨ä¸é€çš„é—®é¢˜æ—¶å¯ä»¥æ·±å…¥å…¶åŸç†æ¥è§£å†³å®ƒã€‚")])]),t._v(" "),a("h3",{attrs:{id:"object-defineproperty"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#object-defineproperty"}},[t._v("#")]),t._v(" "),a("code",[t._v("Object.defineProperty")])]),t._v(" "),a("p",[t._v("é¦–å…ˆæˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹ "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("Object.defineProperty")]),a("OutboundLink")],1),t._v("ï¼ŒVue.jså°±æ˜¯åŸºäºå®ƒå®ç°ã€Œ"),a("strong",[t._v("å“åº”å¼ç³»ç»Ÿ")]),t._v("ã€çš„ã€‚")]),t._v(" "),a("p",[t._v("é¦–å…ˆæ˜¯ä½¿ç”¨æ–¹æ³•ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n    obj: ç›®æ ‡å¯¹è±¡\n    prop: éœ€è¦æ“ä½œçš„ç›®æ ‡å¯¹è±¡çš„å±æ€§å\n    descriptor: æè¿°ç¬¦\n    \n    return value ä¼ å…¥å¯¹è±¡\n*/")]),t._v("\nObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" descriptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("descriptorçš„ä¸€äº›å±æ€§ï¼Œç®€å•ä»‹ç»å‡ ä¸ªå±æ€§ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN æ–‡æ¡£"),a("OutboundLink")],1),t._v("ã€‚")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("enumerable")]),t._v("ï¼Œå±æ€§æ˜¯å¦å¯æšä¸¾ï¼Œé»˜è®¤ falseã€‚")]),t._v(" "),a("li",[a("code",[t._v("configurable")]),t._v("ï¼Œå±æ€§æ˜¯å¦å¯ä»¥è¢«ä¿®æ”¹æˆ–è€…åˆ é™¤ï¼Œé»˜è®¤ falseã€‚")]),t._v(" "),a("li",[a("code",[t._v("get")]),t._v("ï¼Œè·å–å±æ€§çš„æ–¹æ³•ã€‚")]),t._v(" "),a("li",[a("code",[t._v("set")]),t._v("ï¼Œè®¾ç½®å±æ€§çš„æ–¹æ³•ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"å®ç°-observer-å¯è§‚å¯Ÿçš„"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-observer-å¯è§‚å¯Ÿçš„"}},[t._v("#")]),t._v(" å®ç° "),a("code",[t._v("observer")]),t._v("ï¼ˆå¯è§‚å¯Ÿçš„ï¼‰")]),t._v(" "),a("blockquote",[a("p",[t._v("çŸ¥é“äº† "),a("code",[t._v("Object.defineProperty")]),t._v(" ä»¥åï¼Œæˆ‘ä»¬æ¥ç”¨å®ƒä½¿å¯¹è±¡å˜æˆå¯è§‚å¯Ÿçš„ã€‚")])]),t._v(" "),a("p",[t._v("è¿™ä¸€éƒ¨åˆ†çš„å†…å®¹æˆ‘ä»¬åœ¨ç¬¬äºŒå°èŠ‚ä¸­å·²ç»åˆæ­¥ä»‹ç»è¿‡ï¼Œåœ¨ "),a("code",[t._v("init")]),t._v(" çš„é˜¶æ®µä¼šè¿›è¡Œåˆå§‹åŒ–ï¼Œå¯¹æ•°æ®è¿›è¡Œã€Œ"),a("strong",[t._v("å“åº”å¼åŒ–")]),t._v("ã€ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2020/09/129.png",alt:""}})]),t._v(" "),a("ul",[a("li",[t._v("ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘æ•°ç»„ç­‰å¤æ‚çš„æƒ…å†µï¼Œåªå¯¹å¯¹è±¡è¿›è¡Œå¤„ç†ã€‚")]),t._v(" "),a("li",[t._v("é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª "),a("code",[t._v("cb")]),t._v(" å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ç”¨æ¥æ¨¡æ‹Ÿè§†å›¾æ›´æ–°ï¼Œè°ƒç”¨å®ƒå³ä»£è¡¨æ›´æ–°è§†å›¾ï¼Œå†…éƒ¨å¯ä»¥æ˜¯ä¸€äº›æ›´æ–°è§†å›¾çš„æ–¹æ³•ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("val")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* æ¸²æŸ“è§†å›¾ */")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"è§†å›¾æ›´æ–°å•¦ï½"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("ç„¶åæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª "),a("code",[t._v("defineReactive")]),t._v(" ï¼Œè¿™ä¸ªæ–¹æ³•é€šè¿‡ "),a("code",[t._v("Object.defineProperty")]),t._v(" æ¥å®ç°å¯¹å¯¹è±¡çš„ã€Œ"),a("strong",[t._v("å“åº”å¼")]),t._v("ã€åŒ–ï¼Œå…¥å‚æ˜¯ä¸€ä¸ª objï¼ˆéœ€è¦ç»‘å®šçš„å¯¹è±¡ï¼‰ã€keyï¼ˆobjçš„æŸä¸€ä¸ªå±æ€§ï¼‰ï¼Œvalï¼ˆå…·ä½“çš„å€¼ï¼‰ã€‚ç»è¿‡ "),a("code",[t._v("defineReactive")]),t._v(" å¤„ç†ä»¥åï¼Œæˆ‘ä»¬çš„ obj çš„ key å±æ€§åœ¨ã€Œè¯»ã€çš„æ—¶å€™ä¼šè§¦å‘ "),a("code",[t._v("reactiveGetter")]),t._v(" æ–¹æ³•ï¼Œè€Œåœ¨è¯¥å±æ€§è¢«ã€Œå†™ã€çš„æ—¶å€™åˆ™ä¼šè§¦å‘ "),a("code",[t._v("reactiveSetter")]),t._v(" æ–¹æ³•ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineReactive")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" val")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        enumerable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* å±æ€§å¯æšä¸¾ */")]),t._v("\n        configurable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* å±æ€§å¯è¢«ä¿®æ”¹æˆ–åˆ é™¤ */")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactiveGetter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* å®é™…ä¸Šä¼šä¾èµ–æ”¶é›†ï¼Œä¸‹ä¸€å°èŠ‚ä¼šè®² */")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactiveSetter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("newVal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newVal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("å½“ç„¶è¿™æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸Šé¢å†å°è£…ä¸€å±‚ "),a("code",[t._v("observer")]),t._v(" ã€‚è¿™ä¸ªå‡½æ•°ä¼ å…¥ä¸€ä¸ª valueï¼ˆéœ€è¦ã€Œ"),a("strong",[t._v("å“åº”å¼")]),t._v("ã€åŒ–çš„å¯¹è±¡ï¼‰ï¼Œé€šè¿‡éå†æ‰€æœ‰å±æ€§çš„æ–¹å¼å¯¹è¯¥å¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§éƒ½é€šè¿‡ "),a("code",[t._v("defineReactive")]),t._v(" å¤„ç†ã€‚ï¼ˆæ³¨ï¼šå®é™…ä¸Š observer ä¼šè¿›è¡Œé€’å½’è°ƒç”¨ï¼Œä¸ºäº†ä¾¿äºç†è§£å»æ‰äº†é€’å½’çš„è¿‡ç¨‹ï¼‰")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'object'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("keys")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineReactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("ul",[a("li",[t._v("æœ€åï¼Œè®©æˆ‘ä»¬ç”¨ "),a("code",[t._v("observer")]),t._v(" æ¥å°è£…ä¸€ä¸ª Vue å§ï¼")]),t._v(" "),a("li",[t._v("åœ¨ Vue çš„æ„é€ å‡½æ•°ä¸­ï¼Œå¯¹ "),a("code",[t._v("options")]),t._v(" çš„ "),a("code",[t._v("data")]),t._v(" è¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œçš„ "),a("code",[t._v("data")]),t._v(" æƒ³å¿…å¤§å®¶å¾ˆç†Ÿæ‚‰ï¼Œå°±æ˜¯å¹³æ—¶æˆ‘ä»¬åœ¨å†™ Vue é¡¹ç›®æ—¶ç»„ä»¶ä¸­çš„ "),a("code",[t._v("data")]),t._v(" å±æ€§ï¼ˆå®é™…ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™é‡Œå½“ä½œä¸€ä¸ªå¯¹è±¡æ¥ç®€å•å¤„ç†ï¼‰ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Vueæ„é€ ç±» */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("è¿™æ ·æˆ‘ä»¬åªè¦ new ä¸€ä¸ª Vue å¯¹è±¡ï¼Œå°±ä¼šå°† "),a("code",[t._v("data")]),t._v(" ä¸­çš„æ•°æ®è¿›è¡Œã€Œ"),a("strong",[t._v("å“åº”å¼")]),t._v("ã€åŒ–ã€‚å¦‚æœæˆ‘ä»¬å¯¹ "),a("code",[t._v("data")]),t._v(" çš„å±æ€§è¿›è¡Œä¸‹é¢çš„æ“ä½œï¼Œå°±ä¼šè§¦å‘ "),a("code",[t._v("cb")]),t._v(" æ–¹æ³•æ›´æ–°è§†å›¾ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" o "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I am test."')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\no"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello,world."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* è§†å›¾æ›´æ–°å•¦ï½ */")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("è‡³æ­¤ï¼Œå“åº”å¼åŸç†å·²ç»ä»‹ç»å®Œäº†ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬å­¦ä¹ ã€Œ"),a("strong",[t._v("å“åº”å¼ç³»ç»Ÿ")]),t._v("ã€çš„å¦ä¸€éƒ¨åˆ† â€”â€”ã€Œ"),a("strong",[t._v("ä¾èµ–æ”¶é›†")]),t._v("ã€ã€‚")])]),t._v(" "),a("p",[t._v("æ³¨ï¼šæœ¬èŠ‚ä»£ç å‚è€ƒ"),a("a",{attrs:{href:"https://github.com/answershuto/VueDemo/blob/master/%E3%80%8A%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E3%80%8B.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€Šå“åº”å¼ç³»ç»Ÿçš„åŸºæœ¬åŸç†ã€‹"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"ä¸‰ã€å“åº”å¼ç³»ç»Ÿçš„ä¾èµ–æ”¶é›†è¿½è¸ªåŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‰ã€å“åº”å¼ç³»ç»Ÿçš„ä¾èµ–æ”¶é›†è¿½è¸ªåŸç†"}},[t._v("#")]),t._v(" ä¸‰ã€å“åº”å¼ç³»ç»Ÿçš„ä¾èµ–æ”¶é›†è¿½è¸ªåŸç†")]),t._v(" "),a("p",[t._v("#$# ä¸ºä»€ä¹ˆè¦ä¾èµ–æ”¶é›†ï¼Ÿ")]),t._v(" "),a("p",[a("strong",[t._v("å…ˆä¸¾ä¸ªæ —å­ğŸŒ°")])]),t._v(" "),a("p",[t._v("æˆ‘ä»¬ç°åœ¨æœ‰è¿™ä¹ˆä¸€ä¸ª Vue å¯¹è±¡ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" \n        "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<div>\n            <span>{{text1}}</span> \n            <span>{{text2}}</span> \n        <div>")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        text1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        text2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        text3"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text3'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("ç„¶åæˆ‘ä»¬åšäº†è¿™ä¹ˆä¸€ä¸ªæ“ä½œã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("this.text3 = 'modify text3';\n")])])]),a("blockquote",[a("p",[t._v("æˆ‘ä»¬ä¿®æ”¹äº† "),a("code",[t._v("data")]),t._v(" ä¸­ "),a("code",[t._v("text3")]),t._v(" çš„æ•°æ®ï¼Œä½†æ˜¯å› ä¸ºè§†å›¾ä¸­å¹¶ä¸éœ€è¦ç”¨åˆ° "),a("code",[t._v("text3")]),t._v(" ï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶ä¸éœ€è¦è§¦å‘ä¸Šä¸€ç« æ‰€è®²çš„ "),a("code",[t._v("cb")]),t._v(" å‡½æ•°æ¥æ›´æ–°è§†å›¾ï¼Œè°ƒç”¨ "),a("code",[t._v("cb")]),t._v(" æ˜¾ç„¶æ˜¯ä¸æ­£ç¡®çš„ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("å†æ¥ä¸€ä¸ªæ —å­ğŸŒ°")])]),t._v(" "),a("p",[t._v("å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå…¨å±€çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåœ¨å¤šä¸ª Vue å¯¹è±¡ä¸­ç”¨åˆ°å®ƒè¿›è¡Œå±•ç¤ºã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" globalObj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    text1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text1'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" o1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<div>\n            <span>{{text1}}</span> \n        <div>")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" globalObj\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" o2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<div>\n            <span>{{text1}}</span> \n        <div>")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" globalObj\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æ‰§è¡Œäº†å¦‚ä¸‹æ“ä½œã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("globalObj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello,text1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("æˆ‘ä»¬åº”è¯¥éœ€è¦é€šçŸ¥ "),a("code",[t._v("o1")]),t._v(" ä»¥åŠ "),a("code",[t._v("o2")]),t._v(" ä¸¤ä¸ªvmå®ä¾‹è¿›è¡Œè§†å›¾çš„æ›´æ–°ï¼Œã€Œä¾èµ–æ”¶é›†ã€ä¼šè®© "),a("code",[t._v("text1")]),t._v(" è¿™ä¸ªæ•°æ®çŸ¥é“â€œå“¦ï½æœ‰ä¸¤ä¸ªåœ°æ–¹ä¾èµ–æˆ‘çš„æ•°æ®ï¼Œæˆ‘å˜åŒ–çš„æ—¶å€™éœ€è¦é€šçŸ¥å®ƒä»¬ï½â€ã€‚")])]),t._v(" "),a("p",[t._v("æœ€ç»ˆä¼šå½¢æˆæ•°æ®ä¸è§†å›¾çš„ä¸€ç§å¯¹åº”å…³ç³»ï¼Œå¦‚ä¸‹å›¾ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/8.png",alt:""}})]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹ã€Œä¾èµ–æ”¶é›†ã€æ˜¯å¦‚ä½•å®ç°çš„ã€‚")]),t._v(" "),a("h3",{attrs:{id:"è®¢é˜…è€…-dep"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è®¢é˜…è€…-dep"}},[t._v("#")]),t._v(" è®¢é˜…è€… Dep")]),t._v(" "),a("blockquote",[a("p",[t._v("é¦–å…ˆæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªè®¢é˜…è€… "),a("code",[t._v("Dep")]),t._v("ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ç”¨æ¥å­˜æ”¾ "),a("code",[t._v("Watcher")]),t._v(" è§‚å¯Ÿè€…å¯¹è±¡ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* ç”¨æ¥å­˜æ”¾Watcherå¯¹è±¡çš„æ•°ç»„ */")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* åœ¨subsä¸­æ·»åŠ ä¸€ä¸ªWatcherå¯¹è±¡ */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addSub")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("sub")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* é€šçŸ¥æ‰€æœ‰Watcherå¯¹è±¡æ›´æ–°è§†å›¾ */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("notify")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("sub")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("ä¸ºäº†ä¾¿äºç†è§£æˆ‘ä»¬åªå®ç°äº†æ·»åŠ çš„éƒ¨åˆ†ä»£ç ï¼Œä¸»è¦æ˜¯ä¸¤ä»¶äº‹æƒ…ï¼š")])]),t._v(" "),a("ol",[a("li",[t._v("ç”¨ "),a("code",[t._v("addSub")]),t._v(" æ–¹æ³•å¯ä»¥åœ¨ç›®å‰çš„ "),a("code",[t._v("Dep")]),t._v(" å¯¹è±¡ä¸­å¢åŠ ä¸€ä¸ª "),a("code",[t._v("Watcher")]),t._v(" çš„è®¢é˜…æ“ä½œï¼›")]),t._v(" "),a("li",[t._v("ç”¨ "),a("code",[t._v("notify")]),t._v(" æ–¹æ³•é€šçŸ¥ç›®å‰ "),a("code",[t._v("Dep")]),t._v(" å¯¹è±¡çš„ "),a("code",[t._v("subs")]),t._v(" ä¸­çš„æ‰€æœ‰ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡è§¦å‘æ›´æ–°æ“ä½œã€‚")])]),t._v(" "),a("h3",{attrs:{id:"è§‚å¯Ÿè€…-watcher"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è§‚å¯Ÿè€…-watcher"}},[t._v("#")]),t._v(" è§‚å¯Ÿè€… Watcher")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* åœ¨newä¸€ä¸ªWatcherå¯¹è±¡æ—¶å°†è¯¥å¯¹è±¡èµ‹å€¼ç»™Dep.targetï¼Œåœ¨getä¸­ä¼šç”¨åˆ° */")]),t._v("\n        Dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* æ›´æ–°è§†å›¾çš„æ–¹æ³• */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"è§†å›¾æ›´æ–°å•¦ï½"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nDep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"ä¾èµ–æ”¶é›†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¾èµ–æ”¶é›†"}},[t._v("#")]),t._v(" ä¾èµ–æ”¶é›†")]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ "),a("code",[t._v("defineReactive")]),t._v(" ä»¥åŠ Vue çš„æ„é€ å‡½æ•°ï¼Œæ¥å®Œæˆä¾èµ–æ”¶é›†ã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("æˆ‘ä»¬åœ¨é—­åŒ…ä¸­å¢åŠ äº†ä¸€ä¸ª Dep ç±»çš„å¯¹è±¡ï¼Œç”¨æ¥æ”¶é›† "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ã€‚åœ¨å¯¹è±¡è¢«ã€Œè¯»ã€çš„æ—¶å€™ï¼Œä¼šè§¦å‘ "),a("code",[t._v("reactiveGetter")]),t._v(" å‡½æ•°æŠŠå½“å‰çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ï¼ˆå­˜æ”¾åœ¨ Dep.target ä¸­ï¼‰æ”¶é›†åˆ° "),a("code",[t._v("Dep")]),t._v(" ç±»ä¸­å»ã€‚ä¹‹åå¦‚æœå½“è¯¥å¯¹è±¡è¢«ã€Œ"),a("strong",[t._v("å†™")]),t._v("ã€çš„æ—¶å€™ï¼Œåˆ™ä¼šè§¦å‘ "),a("code",[t._v("reactiveSetter")]),t._v(" æ–¹æ³•ï¼Œé€šçŸ¥ "),a("code",[t._v("Dep")]),t._v(" ç±»è°ƒç”¨ "),a("code",[t._v("notify")]),t._v(" æ¥è§¦å‘æ‰€æœ‰ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡çš„ "),a("code",[t._v("update")]),t._v(" æ–¹æ³•æ›´æ–°å¯¹åº”è§†å›¾ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineReactive")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" val")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* ä¸€ä¸ªDepç±»å¯¹è±¡ */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        enumerable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        configurable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactiveGetter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* å°†Dep.targetï¼ˆå³å½“å‰çš„Watcherå¯¹è±¡å­˜å…¥depçš„subsä¸­ï¼‰ */")]),t._v("\n            dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addSub")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("         \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactiveSetter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("newVal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newVal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* åœ¨setçš„æ—¶å€™è§¦å‘depçš„notifyæ¥é€šçŸ¥æ‰€æœ‰çš„Watcherå¯¹è±¡æ›´æ–°è§†å›¾ */")]),t._v("\n            dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("notify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* æ–°å»ºä¸€ä¸ªWatcherè§‚å¯Ÿè€…å¯¹è±¡ï¼Œè¿™æ—¶å€™Dep.targetä¼šæŒ‡å‘è¿™ä¸ªWatcherå¯¹è±¡ */")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* åœ¨è¿™é‡Œæ¨¡æ‹Ÿrenderçš„è¿‡ç¨‹ï¼Œä¸ºäº†è§¦å‘testå±æ€§çš„getå‡½æ•° */")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'render~'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"å°ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å°ç»“"}},[t._v("#")]),t._v(" å°ç»“")]),t._v(" "),a("blockquote",[a("p",[t._v("é¦–å…ˆåœ¨ "),a("code",[t._v("observer")]),t._v(" çš„è¿‡ç¨‹ä¸­ä¼šæ³¨å†Œ "),a("code",[t._v("get")]),t._v(" æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨æ¥è¿›è¡Œã€Œ"),a("strong",[t._v("ä¾èµ–æ”¶é›†")]),t._v("ã€ã€‚åœ¨å®ƒçš„é—­åŒ…ä¸­ä¼šæœ‰ä¸€ä¸ª "),a("code",[t._v("Dep")]),t._v(" å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ç”¨æ¥å­˜æ”¾ Watcher å¯¹è±¡çš„å®ä¾‹ã€‚å…¶å®ã€Œ"),a("strong",[t._v("ä¾èµ–æ”¶é›†")]),t._v("ã€çš„è¿‡ç¨‹å°±æ˜¯æŠŠ "),a("code",[t._v("Watcher")]),t._v(" å®ä¾‹å­˜æ”¾åˆ°å¯¹åº”çš„ "),a("code",[t._v("Dep")]),t._v(" å¯¹è±¡ä¸­å»ã€‚"),a("code",[t._v("get")]),t._v(" æ–¹æ³•å¯ä»¥è®©å½“å‰çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ï¼ˆDep.targetï¼‰å­˜æ”¾åˆ°å®ƒçš„ subs ä¸­ï¼ˆ"),a("code",[t._v("addSub")]),t._v("ï¼‰æ–¹æ³•ï¼Œåœ¨æ•°æ®å˜åŒ–æ—¶ï¼Œ"),a("code",[t._v("set")]),t._v(" ä¼šè°ƒç”¨ "),a("code",[t._v("Dep")]),t._v(" å¯¹è±¡çš„ "),a("code",[t._v("notify")]),t._v(" æ–¹æ³•é€šçŸ¥å®ƒå†…éƒ¨æ‰€æœ‰çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡è¿›è¡Œè§†å›¾æ›´æ–°ã€‚")])]),t._v(" "),a("p",[t._v("è¿™æ˜¯ "),a("code",[t._v("Object.defineProperty")]),t._v(" çš„ "),a("code",[t._v("set/get")]),t._v(" æ–¹æ³•å¤„ç†çš„äº‹æƒ…ï¼Œé‚£ä¹ˆã€Œ"),a("strong",[t._v("ä¾èµ–æ”¶é›†")]),t._v("ã€çš„å‰ææ¡ä»¶è¿˜æœ‰ä¸¤ä¸ªï¼š")]),t._v(" "),a("ol",[a("li",[t._v("è§¦å‘ "),a("code",[t._v("get")]),t._v(" æ–¹æ³•ï¼›")]),t._v(" "),a("li",[t._v("æ–°å»ºä¸€ä¸ª Watcher å¯¹è±¡ã€‚")])]),t._v(" "),a("blockquote",[a("p",[t._v("è¿™ä¸ªæˆ‘ä»¬åœ¨ Vue çš„æ„é€ ç±»ä¸­å¤„ç†ã€‚æ–°å»ºä¸€ä¸ª "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡åªéœ€è¦ new å‡ºæ¥ï¼Œè¿™æ—¶å€™ "),a("code",[t._v("Dep.target")]),t._v(" å·²ç»æŒ‡å‘äº†è¿™ä¸ª new å‡ºæ¥çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡æ¥ã€‚è€Œè§¦å‘ "),a("code",[t._v("get")]),t._v(" æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå®é™…ä¸Šåªè¦æŠŠ render function è¿›è¡Œæ¸²æŸ“ï¼Œé‚£ä¹ˆå…¶ä¸­çš„ä¾èµ–çš„å¯¹è±¡éƒ½ä¼šè¢«ã€Œè¯»å–ã€ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡æ‰“å°æ¥æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œè¯»å– test æ¥è§¦å‘ "),a("code",[t._v("get")]),t._v(" è¿›è¡Œã€Œä¾èµ–æ”¶é›†ã€ã€‚")])]),t._v(" "),a("p",[t._v("æœ¬ç« æˆ‘ä»¬ä»‹ç»äº†ã€Œä¾èµ–æ”¶é›†ã€çš„è¿‡ç¨‹ï¼Œé…åˆä¹‹å‰çš„å“åº”å¼åŸç†ï¼Œå·²ç»æŠŠæ•´ä¸ªã€Œå“åº”å¼ç³»ç»Ÿã€ä»‹ç»å®Œæ¯•äº†ã€‚å…¶ä¸»è¦å°±æ˜¯ "),a("code",[t._v("get")]),t._v(" è¿›è¡Œã€Œä¾èµ–æ”¶é›†ã€ã€‚"),a("code",[t._v("set")]),t._v(" é€šè¿‡è§‚å¯Ÿè€…æ¥æ›´æ–°è§†å›¾ï¼Œé…åˆä¸‹å›¾ä»”ç»†æ‹ä¸€æ‹ï¼Œç›¸ä¿¡ä¸€å®šèƒ½ææ‡‚å®ƒï¼")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/9.png",alt:""}})]),t._v(" "),a("p",[t._v("æ³¨ï¼šæœ¬èŠ‚ä»£ç å‚è€ƒ"),a("a",{attrs:{href:"https://github.com/answershuto/VueDemo/blob/master/%E3%80%8A%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%BE%9D%E8%B5%96%E6%94%B6%E9%9B%86%E8%BF%BD%E8%B8%AA%E5%8E%9F%E7%90%86%E3%80%8B.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€Šå“åº”å¼ç³»ç»Ÿçš„ä¾èµ–æ”¶é›†è¿½è¸ªåŸç†ã€‹"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"å››ã€å®ç°-virtual-dom-ä¸‹çš„ä¸€ä¸ª-vnode-èŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å››ã€å®ç°-virtual-dom-ä¸‹çš„ä¸€ä¸ª-vnode-èŠ‚ç‚¹"}},[t._v("#")]),t._v(" å››ã€å®ç° Virtual DOM ä¸‹çš„ä¸€ä¸ª VNode èŠ‚ç‚¹")]),t._v(" "),a("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯vnode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯vnode"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯VNode")]),t._v(" "),a("blockquote",[a("p",[t._v("æˆ‘ä»¬çŸ¥é“ï¼Œrender function ä¼šè¢«è½¬åŒ–æˆ VNode èŠ‚ç‚¹ã€‚Virtual DOM å…¶å®å°±æ˜¯ä¸€æ£µä»¥ JavaScript å¯¹è±¡ï¼ˆVNode èŠ‚ç‚¹ï¼‰ä½œä¸ºåŸºç¡€çš„æ ‘ï¼Œç”¨å¯¹è±¡å±æ€§æ¥æè¿°èŠ‚ç‚¹ï¼Œå®é™…ä¸Šå®ƒåªæ˜¯ä¸€å±‚å¯¹çœŸå® DOM çš„æŠ½è±¡ã€‚æœ€ç»ˆå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—æ“ä½œä½¿è¿™æ£µæ ‘æ˜ å°„åˆ°çœŸå®ç¯å¢ƒä¸Šã€‚ç”±äº Virtual DOM æ˜¯ä»¥ JavaScript å¯¹è±¡ä¸ºåŸºç¡€è€Œä¸ä¾èµ–çœŸå®å¹³å°ç¯å¢ƒï¼Œæ‰€ä»¥ä½¿å®ƒå…·æœ‰äº†è·¨å¹³å°çš„èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´æµè§ˆå™¨å¹³å°ã€Weexã€Node ç­‰ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"å®ç°ä¸€ä¸ªvnode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°ä¸€ä¸ªvnode"}},[t._v("#")]),t._v(" å®ç°ä¸€ä¸ªVNode")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("VNode")]),t._v(" å½’æ ¹ç»“åº•å°±æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œåªè¦è¿™ä¸ªç±»çš„ä¸€äº›å±æ€§å¯ä»¥æ­£ç¡®ç›´è§‚åœ°æè¿°æ¸…æ¥šå½“å‰èŠ‚ç‚¹çš„ä¿¡æ¯å³å¯ã€‚æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç®€å•çš„ "),a("code",[t._v("VNode")]),t._v(" ç±»ï¼ŒåŠ å…¥ä¸€äº›åŸºæœ¬å±æ€§ï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬å…ˆä¸è€ƒè™‘å¤æ‚çš„æƒ…å†µã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VNode")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" elm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*å½“å‰èŠ‚ç‚¹çš„æ ‡ç­¾å*/")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*å½“å‰èŠ‚ç‚¹çš„ä¸€äº›æ•°æ®ä¿¡æ¯ï¼Œæ¯”å¦‚propsã€attrsç­‰æ•°æ®*/")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*å½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„*/")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*å½“å‰èŠ‚ç‚¹çš„æ–‡æœ¬*/")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*å½“å‰è™šæ‹ŸèŠ‚ç‚¹å¯¹åº”çš„çœŸå®domèŠ‚ç‚¹*/")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("æ¯”å¦‚æˆ‘ç›®å‰æœ‰è¿™ä¹ˆä¸€ä¸ª Vue ç»„ä»¶ã€‚")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("span")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-show")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("isShow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    This is a span.\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("span")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])]),a("p",[t._v("ç”¨ JavaScript ä»£ç å½¢å¼å°±æ˜¯è¿™æ ·çš„ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'span'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* æŒ‡ä»¤é›†åˆæ•°ç»„ */")]),t._v("\n            directives"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* v-showæŒ‡ä»¤ */")]),t._v("\n                    rawName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'v-show'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    expression"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'isShow'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'show'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    value"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* é™æ€class */")]),t._v("\n            staticClass"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'demo'")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'This is a span.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("çœ‹çœ‹è½¬æ¢æˆ "),a("code",[t._v("VNode")]),t._v(" ä»¥åçš„æƒ…å†µã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("{\n    tag: 'span',\n    data: {\n        /* æŒ‡ä»¤é›†åˆæ•°ç»„ */\n        directives: [\n            {\n                /* v-showæŒ‡ä»¤ */\n                rawName: 'v-show',\n                expression: 'isShow',\n                name: 'show',\n                value: true\n            }\n        ],\n        /* é™æ€class */\n        staticClass: 'demo'\n    },\n    text: undefined,\n    children: [\n        /* å­èŠ‚ç‚¹æ˜¯ä¸€ä¸ªæ–‡æœ¬VNodeèŠ‚ç‚¹ */\n        {\n            tag: undefined,\n            data: undefined,\n            text: 'This is a span.',\n            children: undefined\n        }\n    ]\n}\n\n")])])]),a("p",[t._v("ç„¶åæˆ‘ä»¬å¯ä»¥å°† VNode è¿›ä¸€æ­¥å°è£…ä¸€ä¸‹ï¼Œå¯ä»¥å®ç°ä¸€äº›äº§ç”Ÿå¸¸ç”¨ VNode çš„æ–¹æ³•ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("åˆ›å»ºä¸€ä¸ªç©ºèŠ‚ç‚¹")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function createEmptyVNode () {\n    const node = new VNode();\n    node.text = '';\n    return node;\n}\n\n")])])]),a("ul",[a("li",[t._v("åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function createTextVNode (val) {\n  return new VNode(undefined, undefined, undefined, String(val));\n}\n\n")])])]),a("ul",[a("li",[t._v("å…‹éš†ä¸€ä¸ª VNode èŠ‚ç‚¹")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function cloneVNode (node) {\n    const cloneVnode = new VNode(\n        node.tag,\n        node.data,\n        node.children,\n        node.text,\n        node.elm\n    );\n    return cloneVnode;\n}\n\n")])])]),a("blockquote",[a("p",[t._v("æ€»çš„æ¥è¯´ï¼Œ"),a("code",[t._v("VNode")]),t._v(" å°±æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œç”¨ JavaScript å¯¹è±¡çš„å±æ€§æ¥æè¿°å½“å‰èŠ‚ç‚¹çš„ä¸€äº›çŠ¶æ€ï¼Œç”¨ VNode èŠ‚ç‚¹çš„å½¢å¼æ¥æ¨¡æ‹Ÿä¸€æ£µ "),a("code",[t._v("Virtual DOM")]),t._v(" æ ‘ã€‚")])]),t._v(" "),a("p",[t._v("æ³¨ï¼šæœ¬èŠ‚ä»£ç å‚è€ƒ"),a("a",{attrs:{href:"https://github.com/answershuto/VueDemo/blob/master/%E3%80%8A%E5%AE%9E%E7%8E%B0%20Virtual%20DOM%20%E4%B8%8B%E7%9A%84%E4%B8%80%E4%B8%AA%20VNode%20%E8%8A%82%E7%82%B9%E3%80%8B.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€Šå®ç° Virtual DOM ä¸‹çš„ä¸€ä¸ª VNode èŠ‚ç‚¹ã€‹"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"äº”ã€template-æ¨¡æ¿æ˜¯æ€æ ·é€šè¿‡-compile-ç¼–è¯‘çš„"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äº”ã€template-æ¨¡æ¿æ˜¯æ€æ ·é€šè¿‡-compile-ç¼–è¯‘çš„"}},[t._v("#")]),t._v(" äº”ã€template æ¨¡æ¿æ˜¯æ€æ ·é€šè¿‡ Compile ç¼–è¯‘çš„")]),t._v(" "),a("h3",{attrs:{id:"compile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compile"}},[t._v("#")]),t._v(" Compile")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("compile")]),t._v(" ç¼–è¯‘å¯ä»¥åˆ†æˆ "),a("code",[t._v("parse")]),t._v("ã€"),a("code",[t._v("optimize")]),t._v(" ä¸ "),a("code",[t._v("generate")]),t._v(" ä¸‰ä¸ªé˜¶æ®µï¼Œæœ€ç»ˆéœ€è¦å¾—åˆ° render functionã€‚è¿™éƒ¨åˆ†å†…å®¹ä¸ç®— Vue.js çš„å“åº”å¼æ ¸å¿ƒï¼Œåªæ˜¯ç”¨æ¥ç¼–è¯‘çš„ï¼Œç¬”è€…è®¤ä¸ºåœ¨ç²¾åŠ›æœ‰é™çš„æƒ…å†µä¸‹ä¸éœ€è¦è¿½ç©¶å…¶å…¨éƒ¨çš„å®ç°ç»†èŠ‚ï¼Œèƒ½å¤ŸæŠŠæ¡å¦‚ä½•è§£æçš„å¤§è‡´æµç¨‹å³å¯ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/10.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("ç”±äºè§£æè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œç›´æ¥ä¸Šä»£ç å¯èƒ½ä¼šå¯¼è‡´ä¸äº†è§£è¿™éƒ¨åˆ†å†…å®¹çš„åŒå­¦ä¸€å¤´é›¾æ°´ã€‚æ‰€ä»¥ç¬”è€…å‡†å¤‡æä¾›ä¸€ä¸ª template çš„ç¤ºä¾‹ï¼Œé€šè¿‡è¿™ä¸ªç¤ºä¾‹çš„å˜åŒ–æ¥çœ‹è§£æçš„è¿‡ç¨‹ã€‚ä½†æ˜¯è§£æçš„è¿‡ç¨‹åŠç»“æœéƒ½æ˜¯å°†æœ€é‡è¦çš„éƒ¨åˆ†æŠ½ç¦»å‡ºæ¥å±•ç¤ºï¼Œå¸Œæœ›èƒ½è®©è¯»è€…æ›´å¥½åœ°äº†è§£å…¶æ ¸å¿ƒéƒ¨åˆ†çš„å®ç°ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('<div :class="c" class="demo" v-if="isShow">\n    <span v-for="item in sz">{{item}}</span>\n</div>\n\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('var html = \'<div :class="c" class="demo" v-if="isShow"><span v-for="item in sz">{{item}}</span></div>\';\n\n')])])]),a("p",[t._v("æ¥ä¸‹æ¥çš„è¿‡ç¨‹éƒ½ä¼šä¾èµ–è¿™ä¸ªç¤ºä¾‹æ¥è¿›è¡Œã€‚")]),t._v(" "),a("h3",{attrs:{id:"parse"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parse"}},[t._v("#")]),t._v(" parse")]),t._v(" "),a("p",[t._v("é¦–å…ˆæ˜¯ "),a("code",[t._v("parse")]),t._v("ï¼Œ"),a("code",[t._v("parse")]),t._v(" ä¼šç”¨æ­£åˆ™ç­‰æ–¹å¼å°† template æ¨¡æ¿ä¸­è¿›è¡Œå­—ç¬¦ä¸²è§£æï¼Œå¾—åˆ°æŒ‡ä»¤ã€classã€styleç­‰æ•°æ®ï¼Œå½¢æˆ ASTï¼ˆ"),a("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E6%8A%BD%E8%B1%A1%E8%AA%9E%E6%B3%95%E6%A8%B9",target:"_blank",rel:"noopener noreferrer"}},[t._v("åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒæŠ½è±¡è¯­æ³•æ ‘ï¼ˆabstract syntax treeæˆ–è€…ç¼©å†™ä¸ºASTï¼‰ï¼Œæˆ–è€…è¯­æ³•æ ‘ï¼ˆsyntax treeï¼‰ï¼Œæ˜¯æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç°å½¢å¼ï¼Œè¿™é‡Œç‰¹æŒ‡ç¼–ç¨‹è¯­è¨€çš„æºä»£ç ã€‚"),a("OutboundLink")],1),t._v("ï¼‰ã€‚")]),t._v(" "),a("p",[t._v("è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œä¼šæ¶‰åŠåˆ°æ¯”è¾ƒå¤šçš„æ­£åˆ™è¿›è¡Œå­—ç¬¦ä¸²è§£æï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¾—åˆ°çš„ AST çš„æ ·å­ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("{\n    /* æ ‡ç­¾å±æ€§çš„mapï¼Œè®°å½•äº†æ ‡ç­¾ä¸Šå±æ€§ */\n    'attrsMap': {\n        ':class': 'c',\n        'class': 'demo',\n        'v-if': 'isShow'\n    },\n    /* è§£æå¾—åˆ°çš„:class */\n    'classBinding': 'c',\n    /* æ ‡ç­¾å±æ€§v-if */\n    'if': 'isShow',\n    /* v-ifçš„æ¡ä»¶ */\n    'ifConditions': [\n        {\n            'exp': 'isShow'\n        }\n    ],\n    /* æ ‡ç­¾å±æ€§class */\n    'staticClass': 'demo',\n    /* æ ‡ç­¾çš„tag */\n    'tag': 'div',\n    /* å­æ ‡ç­¾æ•°ç»„ */\n    'children': [\n        {\n            'attrsMap': {\n                'v-for': \"item in sz\"\n            },\n            /* forå¾ªç¯çš„å‚æ•° */\n            'alias': \"item\",\n            /* forå¾ªç¯çš„å¯¹è±¡ */\n            'for': 'sz',\n            /* forå¾ªç¯æ˜¯å¦å·²ç»è¢«å¤„ç†çš„æ ‡è®°ä½ */\n            'forProcessed': true,\n            'tag': 'span',\n            'children': [\n                {\n                    /* è¡¨è¾¾å¼ï¼Œ_sæ˜¯ä¸€ä¸ªè½¬å­—ç¬¦ä¸²çš„å‡½æ•° */\n                    'expression': '_s(item)',\n                    'text': '{{item}}'\n                }\n            ]\n        }\n    ]\n}\n\n\n")])])]),a("ul",[a("li",[t._v("æœ€ç»ˆå¾—åˆ°çš„ AST é€šè¿‡ä¸€äº›ç‰¹å®šçš„å±æ€§ï¼Œèƒ½å¤Ÿæ¯”è¾ƒæ¸…æ™°åœ°æè¿°å‡ºæ ‡ç­¾çš„å±æ€§ä»¥åŠä¾èµ–å…³ç³»ã€‚")]),t._v(" "),a("li",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ä»£ç æ¥è®²è§£ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨æ­£åˆ™æ¥æŠŠ template ç¼–è¯‘æˆæˆ‘ä»¬éœ€è¦çš„ AST çš„ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"æ­£åˆ™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ­£åˆ™"}},[t._v("#")]),t._v(" æ­£åˆ™")]),t._v(" "),a("p",[t._v("é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸‹æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šç”¨åˆ°çš„æ­£åˆ™ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("const ncname = '[a-zA-Z_][\\\\w\\\\-\\\\.]*';\nconst singleAttrIdentifier = /([^\\s\"'<>/=]+)/\nconst singleAttrAssign = /(?:=)/\nconst singleAttrValues = [\n  /\"([^\"]*)\"+/.source,\n  /'([^']*)'+/.source,\n  /([^\\s\"'=<>`]+)/.source\n]\nconst attribute = new RegExp(\n  '^\\\\s*' + singleAttrIdentifier.source +\n  '(?:\\\\s*(' + singleAttrAssign.source + ')' +\n  '\\\\s*(?:' + singleAttrValues.join('|') + '))?'\n)\n\nconst qnameCapture = '((?:' + ncname + '\\\\:)?' + ncname + ')'\nconst startTagOpen = new RegExp('^<' + qnameCapture)\nconst startTagClose = /^\\s*(\\/?)>/\n\nconst endTag = new RegExp('^<\\\\/' + qnameCapture + '[^>]*>')\n\nconst defaultTagRE = /\\{\\{((?:.|\\n)+?)\\}\\}/g\n\nconst forAliasRE = /(.*?)\\s+(?:in|of)\\s+(.*)/\n\n")])])]),a("h3",{attrs:{id:"advance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#advance"}},[t._v("#")]),t._v(" advance")]),t._v(" "),a("blockquote",[a("p",[t._v("å› ä¸ºæˆ‘ä»¬è§£æ template é‡‡ç”¨å¾ªç¯è¿›è¡Œå­—ç¬¦ä¸²åŒ¹é…çš„æ–¹å¼ï¼Œæ‰€ä»¥æ¯åŒ¹é…è§£æå®Œä¸€æ®µæˆ‘ä»¬éœ€è¦å°†å·²ç»åŒ¹é…æ‰çš„å»æ‰ï¼Œå¤´éƒ¨çš„æŒ‡é’ˆæŒ‡å‘æ¥ä¸‹æ¥éœ€è¦åŒ¹é…çš„éƒ¨åˆ†ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function advance (n) {\n    index += n\n    html = html.substring(n)\n}\n\n")])])]),a("p",[t._v("ä¸¾ä¸ªä¾‹å­ï¼Œå½“æˆ‘ä»¬æŠŠç¬¬ä¸€ä¸ª div çš„å¤´æ ‡ç­¾å…¨éƒ¨åŒ¹é…å®Œæ¯•ä»¥åï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™éƒ¨åˆ†é™¤å»ï¼Œä¹Ÿå°±æ˜¯å‘å³ç§»åŠ¨ 43 ä¸ªå­—ç¬¦ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/11.png",alt:""}})]),t._v(" "),a("p",[t._v("è°ƒç”¨ "),a("code",[t._v("advance")]),t._v(" å‡½æ•°")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("advance(43);\n\n")])])]),a("p",[t._v("å¾—åˆ°ç»“æœ")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/12.png",alt:""}})]),t._v(" "),a("p",[a("strong",[t._v("3.1 parseHTML")])]),t._v(" "),a("blockquote",[a("p",[t._v("é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸ª "),a("code",[t._v("parseHTML")]),t._v(" å‡½æ•°ï¼Œåœ¨é‡Œé¢æˆ‘ä»¬å¾ªç¯è§£æ template å­—ç¬¦ä¸²ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseHTML")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" textEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("indexOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("textEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("endTag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...process end tag")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startTagOpen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...process start tag")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...process text")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("code",[t._v("parseHTML")]),t._v(" ä¼šç”¨ "),a("code",[t._v("while")]),t._v(" æ¥å¾ªç¯è§£æ template ï¼Œç”¨æ­£åˆ™åœ¨åŒ¹é…åˆ°æ ‡ç­¾å¤´ã€æ ‡ç­¾å°¾ä»¥åŠæ–‡æœ¬çš„æ—¶å€™åˆ†åˆ«è¿›è¡Œä¸åŒçš„å¤„ç†ã€‚ç›´åˆ°æ•´ä¸ª template è¢«è§£æå®Œæ¯•ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("3.2 parseStartTag")])]),t._v(" "),a("blockquote",[a("p",[t._v("æˆ‘ä»¬æ¥å†™ä¸€ä¸ª "),a("code",[t._v("parseStartTag")]),t._v(' å‡½æ•°ï¼Œç”¨æ¥è§£æèµ·å§‹æ ‡ç­¾ï¼ˆ"'),a("code",[t._v('<div :class="c" class="demo" v-if="isShow">')]),t._v('"éƒ¨åˆ†çš„å†…å®¹ï¼‰ã€‚')])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseStartTag")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startTagOpen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" match "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            tagName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            attrs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            start"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" index\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("advance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" attr\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("end "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startTagClose"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("attr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("attribute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("advance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                value"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("unarySlash "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("advance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("end "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" match\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("é¦–å…ˆç”¨ "),a("code",[t._v("startTagOpen")]),t._v(" æ­£åˆ™å¾—åˆ°æ ‡ç­¾çš„å¤´éƒ¨ï¼Œå¯ä»¥å¾—åˆ° "),a("code",[t._v("tagName")]),t._v("ï¼ˆæ ‡ç­¾åç§°ï¼‰ï¼ŒåŒæ—¶æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°ç»„ "),a("code",[t._v("attrs")]),t._v(" ç”¨æ¥å­˜æ”¾æ ‡ç­¾å†…çš„å±æ€§ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("const start = html.match(startTagOpen);\nconst match = {\n    tagName: start[1],\n    attrs: [],\n    start: index\n}\nadvance(start[0].length);\n\n")])])]),a("p",[t._v("æ¥ä¸‹æ¥ä½¿ç”¨ "),a("code",[t._v("startTagClose")]),t._v(" ä¸ "),a("code",[t._v("attribute")]),t._v(" ä¸¤ä¸ªæ­£åˆ™åˆ†åˆ«ç”¨æ¥è§£ææ ‡ç­¾ç»“æŸä»¥åŠæ ‡ç­¾å†…çš„å±æ€§ã€‚è¿™æ®µä»£ç ç”¨ "),a("code",[t._v("while")]),t._v(" å¾ªç¯ä¸€ç›´åˆ°åŒ¹é…åˆ° "),a("code",[t._v("startTagClose")]),t._v(" ä¸ºæ­¢ï¼Œè§£æå†…éƒ¨æ‰€æœ‰çš„å±æ€§ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("let end, attr\nwhile (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n    advance(attr[0].length)\n    match.attrs.push({\n        name: attr[1],\n        value: attr[3]\n    });\n}\nif (end) {\n    match.unarySlash = end[1];\n    advance(end[0].length);\n    match.end = index;\n    return match\n}\n\n")])])]),a("h3",{attrs:{id:"stack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stack"}},[t._v("#")]),t._v(" stack")]),t._v(" "),a("blockquote",[a("p",[t._v("æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸€ä¸ª "),a("strong",[t._v("stack")]),t._v(" æ ˆæ¥ä¿å­˜å·²ç»è§£æå¥½çš„æ ‡ç­¾å¤´ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ ¹æ®åœ¨è§£æå°¾éƒ¨æ ‡ç­¾çš„æ—¶å€™å¾—åˆ°æ‰€å±çš„å±‚çº§å…³ç³»ä»¥åŠçˆ¶æ ‡ç­¾ã€‚åŒæ—¶æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª "),a("code",[t._v("currentParent")]),t._v(" å˜é‡ç”¨æ¥å­˜æ”¾å½“å‰æ ‡ç­¾çš„çˆ¶æ ‡ç­¾èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œ "),a("code",[t._v("root")]),t._v(" å˜é‡ç”¨æ¥æŒ‡å‘æ ¹æ ‡ç­¾èŠ‚ç‚¹ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" stack "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" currentParent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/13.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("çŸ¥é“è¿™ä¸ªä»¥åï¼Œæˆ‘ä»¬ä¼˜åŒ–ä¸€ä¸‹ "),a("code",[t._v("parseHTML")]),t._v(" ï¼Œåœ¨ "),a("code",[t._v("startTagOpen")]),t._v(" çš„ "),a("code",[t._v("if")]),t._v(" é€»è¾‘ä¸­åŠ ä¸Šæ–°çš„å¤„ç†ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startTagOpen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" startTagMatch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseStartTag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        tag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" startTagMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tagName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        lowerCasedTag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" startTagMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tagName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toLowerCase")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        attrsList"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" startTagMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        attrsMap"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeAttrsMap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startTagMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        parent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" currentParent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        children"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        root "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" element\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentParent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        currentParent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    stack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    currentParent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("æˆ‘ä»¬å°† "),a("code",[t._v("startTagMatch")]),t._v(" å¾—åˆ°çš„ç»“æœé¦–å…ˆå°è£…æˆ "),a("code",[t._v("element")]),t._v(" ï¼Œè¿™ä¸ªå°±æ˜¯æœ€ç»ˆå½¢æˆçš„ AST çš„èŠ‚ç‚¹ï¼Œæ ‡ç­¾èŠ‚ç‚¹çš„ type ä¸º 1ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("const startTagMatch = parseStartTag();\nconst element = {\n    type: 1,\n    tag: startTagMatch.tagName,\n    attrsList: startTagMatch.attrs,\n    attrsMap: makeAttrsMap(startTagMatch.attrs),\n    parent: currentParent,\n    children: []\n}\n\n")])])]),a("p",[t._v("ç„¶åè®© "),a("code",[t._v("root")]),t._v(" æŒ‡å‘æ ¹èŠ‚ç‚¹çš„å¼•ç”¨ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("if(!root){\n    root = element\n}\n\n")])])]),a("p",[t._v("æ¥ç€æˆ‘ä»¬å°†å½“å‰èŠ‚ç‚¹çš„ "),a("code",[t._v("element")]),t._v(" æ”¾å…¥çˆ¶èŠ‚ç‚¹ "),a("code",[t._v("currentParent")]),t._v(" çš„ "),a("code",[t._v("children")]),t._v(" æ•°ç»„ä¸­ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("if(currentParent){\n    currentParent.children.push(element);\n}\n\n")])])]),a("blockquote",[a("p",[t._v("æœ€åå°†å½“å‰èŠ‚ç‚¹ "),a("code",[t._v("element")]),t._v(" å‹å…¥ stack æ ˆä¸­ï¼Œå¹¶å°† "),a("code",[t._v("currentParent")]),t._v(" æŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œå› ä¸ºæ¥ä¸‹å»ä¸‹ä¸€ä¸ªè§£æå¦‚æœè¿˜æ˜¯å¤´æ ‡ç­¾æˆ–è€…æ˜¯æ–‡æœ¬çš„è¯ï¼Œä¼šæˆä¸ºå½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯å°¾æ ‡ç­¾çš„è¯ï¼Œé‚£ä¹ˆå°†ä¼šä»æ ˆä¸­å–å‡ºå½“å‰èŠ‚ç‚¹ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬æ¥ä¸‹æ¥è¦è®²ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("stack.push(element);\ncurrentParent = element;\ncontinue;\n\n")])])]),a("p",[t._v("å…¶ä¸­çš„ "),a("code",[t._v("makeAttrsMap")]),t._v(" æ˜¯å°† attrs è½¬æ¢æˆ map æ ¼å¼çš„ä¸€ä¸ªæ–¹æ³•ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function makeAttrsMap (attrs) {\n    const map = {}\n    for (let i = 0, l = attrs.length; i < l; i++) {\n        map[attrs[i].name] = attrs[i].value;\n    }\n    return map\n}\n\n")])])]),a("h3",{attrs:{id:"parseendtag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parseendtag"}},[t._v("#")]),t._v(" parseEndTag")]),t._v(" "),a("blockquote",[a("p",[t._v("åŒæ ·ï¼Œæˆ‘ä»¬åœ¨ "),a("code",[t._v("parseHTML")]),t._v(" ä¸­åŠ å…¥å¯¹å°¾æ ‡ç­¾çš„è§£æå‡½æ•°ï¼Œä¸ºäº†åŒ¹é…å¦‚â€œ"),t._v("â€ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("const endTagMatch = html.match(endTag)\n if (endTagMatch) {\n    advance(endTagMatch[0].length);\n    parseEndTag(endTagMatch[1]);\n    continue;\n}\n\n")])])]),a("blockquote",[a("p",[t._v("ç”¨ "),a("code",[t._v("parseEndTag")]),t._v(" æ¥è§£æå°¾æ ‡ç­¾ï¼Œå®ƒä¼šä» stack æ ˆä¸­å–å‡ºæœ€è¿‘çš„è·Ÿè‡ªå·±æ ‡ç­¾åä¸€è‡´çš„é‚£ä¸ªå…ƒç´ ï¼Œå°† "),a("code",[t._v("currentParent")]),t._v(" æŒ‡å‘é‚£ä¸ªå…ƒç´ ï¼Œå¹¶å°†è¯¥å…ƒç´ ä¹‹å‰çš„å…ƒç´ éƒ½ä» stack ä¸­å‡ºæ ˆã€‚")])]),t._v(" "),a("p",[t._v("è¿™é‡Œå¯èƒ½æœ‰åŒå­¦ä¼šé—®ï¼Œéš¾é“è§£æçš„å°¾å…ƒç´ ä¸åº”è¯¥å¯¹åº” stack æ ˆçš„æœ€ä¸Šé¢çš„ä¸€ä¸ªå…ƒç´ æ‰å¯¹å—ï¼Ÿ")]),t._v(" "),a("blockquote",[a("p",[t._v("å…¶å®ä¸ç„¶ï¼Œæ¯”å¦‚è¯´å¯èƒ½ä¼šå­˜åœ¨è‡ªé—­åˆçš„æ ‡ç­¾ï¼Œå¦‚â€œ"),a("code",[t._v("<br />")]),t._v("â€ï¼Œæˆ–è€…æ˜¯å†™äº†â€œ"),a("code",[t._v("<span>")]),t._v("â€ä½†æ˜¯æ²¡æœ‰åŠ ä¸Šâ€œ"),a("code",[t._v("< /span>")]),t._v("â€çš„æƒ…å†µï¼Œè¿™æ—¶å€™å°±è¦æ‰¾åˆ° stack ä¸­çš„ç¬¬äºŒä¸ªä½ç½®æ‰èƒ½æ‰¾åˆ°åŒåæ ‡ç­¾ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseEndTag")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" stack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" pos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" pos"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("stack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lowerCasedTag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" tagName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toLowerCase")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        stack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        currentParent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" stack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("   \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"parsetext"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parsetext"}},[t._v("#")]),t._v(" parseText")]),t._v(" "),a("blockquote",[a("p",[t._v("æœ€åæ˜¯è§£ææ–‡æœ¬ï¼Œè¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦å°†æ–‡æœ¬å–å‡ºï¼Œç„¶åæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯æ™®é€šçš„æ–‡æœ¬ï¼Œç›´æ¥æ„å»ºä¸€ä¸ªèŠ‚ç‚¹ push è¿›å½“å‰ "),a("code",[t._v("currentParent")]),t._v(" çš„ children ä¸­å³å¯ã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æ–‡æœ¬æ˜¯å¦‚â€œ{item}â€è¿™æ ·çš„ Vue.js çš„è¡¨è¾¾å¼ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ç”¨ "),a("code",[t._v("parseText")]),t._v(" æ¥å°†è¡¨è¾¾å¼è½¬åŒ–æˆä»£ç ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("substring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" textEnd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("advance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("textEnd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" expression"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("expression "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    currentParent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        expression\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    currentParent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("æˆ‘ä»¬ä¼šç”¨åˆ°ä¸€ä¸ª "),a("code",[t._v("parseText")]),t._v(" å‡½æ•°ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseText")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("defaultTagRE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tokens "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" lastIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" defaultTagRE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("match "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" defaultTagRE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("index\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" lastIndex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            tokens"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lastIndex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" exp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        tokens"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("_s(")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("exp"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        lastIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lastIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        tokens"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lastIndex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" tokens"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'+'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª "),a("code",[t._v("tokens")]),t._v(" æ•°ç»„æ¥å­˜æ”¾è§£æç»“æœï¼Œé€šè¿‡ "),a("code",[t._v("defaultTagRE")]),t._v(" æ¥å¾ªç¯åŒ¹é…è¯¥æ–‡æœ¬ï¼Œå¦‚æœæ˜¯æ™®é€šæ–‡æœ¬ç›´æ¥ "),a("code",[t._v("push")]),t._v(" åˆ° "),a("code",[t._v("tokens")]),t._v(" æ•°ç»„ä¸­å»ï¼Œå¦‚æœæ˜¯è¡¨è¾¾å¼ï¼ˆ"),a("code",[t._v("{item}")]),t._v("ï¼‰ï¼Œåˆ™è½¬åŒ–æˆâ€œ"),a("code",[t._v("\\_s(${exp})")]),t._v("â€çš„å½¢å¼ã€‚")])]),t._v(" "),a("p",[t._v("ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªæ–‡æœ¬ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("<div>hello,{{name}}.</div>\n\n")])])]),a("p",[t._v("æœ€ç»ˆå¾—åˆ° "),a("code",[t._v("tokens")]),t._v("ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("tokens = ['hello,', _s(name), '.'];\n\n")])])]),a("p",[t._v("æœ€ç»ˆé€šè¿‡ "),a("code",[t._v("join")]),t._v(" è¿”å›è¡¨è¾¾å¼ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("'hello' + _s(name) + '.';\n\n")])])]),a("h3",{attrs:{id:"processifä¸processfor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processifä¸processfor"}},[t._v("#")]),t._v(" processIfä¸processFor")]),t._v(" "),a("blockquote",[a("p",[t._v("æœ€åä»‹ç»ä¸€ä¸‹å¦‚ä½•å¤„ç†â€œ"),a("code",[t._v("v-if")]),t._v("â€ä»¥åŠâ€œ"),a("code",[t._v("v-for")]),t._v("â€è¿™æ ·çš„ Vue.js çš„è¡¨è¾¾å¼çš„ï¼Œè¿™é‡Œæˆ‘ä»¬åªç®€å•ä»‹ç»ä¸¤ä¸ªç¤ºä¾‹ä¸­ç”¨åˆ°çš„è¡¨è¾¾å¼è§£æã€‚")])]),t._v(" "),a("p",[t._v("æˆ‘ä»¬åªéœ€è¦åœ¨è§£æå¤´æ ‡ç­¾çš„å†…å®¹ä¸­åŠ å…¥è¿™ä¸¤ä¸ªè¡¨è¾¾å¼çš„è§£æå‡½æ•°å³å¯ï¼Œåœ¨è¿™æ—¶â€œ"),a("code",[t._v("v-for")]),t._v("â€ä¹‹ç±»æŒ‡ä»¤å·²ç»åœ¨å±æ€§è§£ææ—¶å­˜å…¥äº† "),a("code",[t._v("attrsMap")]),t._v(" ä¸­äº†ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startTagOpen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" startTagMatch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseStartTag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        tag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" startTagMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tagName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        attrsList"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" startTagMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        attrsMap"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeAttrsMap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startTagMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        parent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" currentParent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        children"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("processIf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("processFor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        root "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" element\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentParent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        currentParent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    stack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    currentParent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ª "),a("code",[t._v("getAndRemoveAttr")]),t._v(" å‡½æ•°ï¼Œç”¨æ¥ä» "),a("code",[t._v("el")]),t._v(" çš„ "),a("code",[t._v("attrsMap")]),t._v(" å±æ€§æˆ–æ˜¯ "),a("code",[t._v("attrsList")]),t._v(" å±æ€§ä¸­å–å‡º "),a("code",[t._v("name")]),t._v(" å¯¹åº”å€¼ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAndRemoveAttr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" val\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("val "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" list "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrsList\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" l "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("splice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("   \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" val\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("æ¯”å¦‚è¯´è§£æç¤ºä¾‹çš„ div æ ‡ç­¾å±æ€§ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAndRemoveAttr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'v-for'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("å¯æœ‰å¾—åˆ°â€œitem in szâ€ã€‚")]),t._v(" "),a("p",[t._v("æœ‰äº†è¿™ä¸ªå‡½æ•°è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å®ç° "),a("code",[t._v("processFor")]),t._v(" ä¸ "),a("code",[t._v("processIf")]),t._v(" äº†ã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("â€œv-forâ€ä¼šå°†æŒ‡ä»¤è§£ææˆ "),a("code",[t._v("for")]),t._v(" å±æ€§ä»¥åŠ "),a("code",[t._v("alias")]),t._v(" å±æ€§ï¼Œè€Œâ€œv-ifâ€ä¼šå°†æ¡ä»¶éƒ½å­˜å…¥ "),a("code",[t._v("ifConditions")]),t._v(" æ•°ç»„ä¸­ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("processFor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAndRemoveAttr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'v-for'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" inMatch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("forAliasRE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("for "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" inMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alias "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" inMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("processIf")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" exp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAndRemoveAttr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'v-if'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("if "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ifConditions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ifConditions "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ifConditions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            exp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            block"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" el\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»æŠŠ "),a("code",[t._v("parse")]),t._v(" çš„è¿‡ç¨‹ä»‹ç»å®Œäº†ï¼Œæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹ "),a("code",[t._v("optimize")]),t._v("ã€‚")]),t._v(" "),a("h3",{attrs:{id:"optimize"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#optimize"}},[t._v("#")]),t._v(" optimize")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("optimize")]),t._v(" ä¸»è¦ä½œç”¨å°±è·Ÿå®ƒçš„åå­—ä¸€æ ·ï¼Œç”¨ä½œã€Œä¼˜åŒ–ã€ã€‚")])]),t._v(" "),a("p",[t._v("è¿™ä¸ªæ¶‰åŠåˆ°åé¢è¦è®² "),a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹ï¼Œå› ä¸º "),a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹å®é™…ä¸Šæ˜¯å°† VNode èŠ‚ç‚¹è¿›è¡Œä¸€å±‚ä¸€å±‚çš„æ¯”å¯¹ï¼Œç„¶åå°†ã€Œå·®å¼‚ã€æ›´æ–°åˆ°è§†å›¾ä¸Šã€‚é‚£ä¹ˆä¸€äº›é™æ€èŠ‚ç‚¹æ˜¯ä¸ä¼šæ ¹æ®æ•°æ®å˜åŒ–è€Œäº§ç”Ÿå˜åŒ–çš„ï¼Œè¿™äº›èŠ‚ç‚¹æˆ‘ä»¬æ²¡æœ‰æ¯”å¯¹çš„éœ€æ±‚ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥è·³è¿‡è¿™äº›é™æ€èŠ‚ç‚¹çš„æ¯”å¯¹ï¼Œä»è€ŒèŠ‚çœä¸€äº›æ€§èƒ½å‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä¸ºé™æ€çš„èŠ‚ç‚¹åšä¸Šä¸€äº›ã€Œæ ‡è®°ã€ï¼Œåœ¨ "),a("code",[t._v("patch")]),t._v(" çš„æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è·³è¿‡è¿™äº›è¢«æ ‡è®°çš„èŠ‚ç‚¹çš„æ¯”å¯¹ï¼Œä»è€Œè¾¾åˆ°ã€Œä¼˜åŒ–ã€çš„ç›®çš„ã€‚")]),t._v(" "),a("p",[t._v("ç»è¿‡ "),a("code",[t._v("optimize")]),t._v(" è¿™å±‚çš„å¤„ç†ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¼šåŠ ä¸Š "),a("code",[t._v("static")]),t._v(" å±æ€§ï¼Œç”¨æ¥æ ‡è®°æ˜¯å¦æ˜¯é™æ€çš„ã€‚")]),t._v(" "),a("p",[t._v("å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("{\n    'attrsMap': {\n        ':class': 'c',\n        'class': 'demo',\n        'v-if': 'isShow'\n    },\n    'classBinding': 'c',\n    'if': 'isShow',\n    'ifConditions': [\n        'exp': 'isShow'\n    ],\n    'staticClass': 'demo',\n    'tag': 'div',\n    /* é™æ€æ ‡å¿— */\n    'static': false,\n    'children': [\n        {\n            'attrsMap': {\n                'v-for': \"item in sz\"\n            },\n            'static': false,\n            'alias': \"item\",\n            'for': 'sz',\n            'forProcessed': true,\n            'tag': 'span',\n            'children': [\n                {\n                    'expression': '_s(item)',\n                    'text': '{{item}}',\n                    'static': false\n                }\n            ]\n        }\n    ]\n}\n\n\n")])])]),a("p",[t._v("æˆ‘ä»¬ç”¨ä»£ç å®ç°ä¸€ä¸‹ "),a("code",[t._v("optimize")]),t._v(" å‡½æ•°ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("1. isStatic")])]),t._v(" "),a("blockquote",[a("p",[t._v("é¦–å…ˆå®ç°ä¸€ä¸ª "),a("code",[t._v("isStatic")]),t._v(" å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ª node åˆ¤æ–­è¯¥ node æ˜¯å¦æ˜¯é™æ€èŠ‚ç‚¹ã€‚åˆ¤æ–­çš„æ ‡å‡†æ˜¯å½“ type ä¸º 2ï¼ˆè¡¨è¾¾å¼èŠ‚ç‚¹ï¼‰åˆ™æ˜¯éé™æ€èŠ‚ç‚¹ï¼Œå½“ type ä¸º 3ï¼ˆæ–‡æœ¬èŠ‚ç‚¹ï¼‰çš„æ—¶å€™åˆ™æ˜¯é™æ€èŠ‚ç‚¹ï¼Œå½“ç„¶ï¼Œå¦‚æœå­˜åœ¨ "),a("code",[t._v("if")]),t._v(" æˆ–è€… "),a("code",[t._v("for")]),t._v("è¿™æ ·çš„æ¡ä»¶çš„æ—¶å€™ï¼ˆè¡¨è¾¾å¼èŠ‚ç‚¹ï¼‰ï¼Œä¹Ÿæ˜¯éé™æ€èŠ‚ç‚¹ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function isStatic (node) {\n    if (node.type === 2) {\n        return false\n    }\n    if (node.type === 3) {\n        return true\n    }\n    return (!node.if && !node.for);\n}\n\n")])])]),a("p",[a("strong",[t._v("2. markStatic")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("markStatic")]),t._v(" ä¸ºæ‰€æœ‰çš„èŠ‚ç‚¹æ ‡è®°ä¸Š "),a("code",[t._v("static")]),t._v("ï¼Œéå†æ‰€æœ‰èŠ‚ç‚¹é€šè¿‡ "),a("code",[t._v("isStatic")]),t._v(" æ¥åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦æ˜¯é™æ€èŠ‚ç‚¹ï¼Œæ­¤å¤–ï¼Œä¼šéå†å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œå¦‚æœå­èŠ‚ç‚¹æ˜¯éé™æ€èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå½“å‰èŠ‚ç‚¹ä¹Ÿæ˜¯éé™æ€èŠ‚ç‚¹ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("markStatic")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("static "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isStatic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" l "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" child "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("markStatic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("child"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("static"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("static "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("3. markStaticRoots")])]),t._v(" "),a("blockquote",[a("p",[t._v("æ¥ä¸‹æ¥æ˜¯ "),a("code",[t._v("markStaticRoots")]),t._v(" å‡½æ•°ï¼Œç”¨æ¥æ ‡è®° "),a("code",[t._v("staticRoot")]),t._v("ï¼ˆé™æ€æ ¹ï¼‰ã€‚è¿™ä¸ªå‡½æ•°å®ç°æ¯”è¾ƒç®€å•ï¼Œç®€å•æ¥å°†å°±æ˜¯å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯é™æ€èŠ‚ç‚¹ï¼ŒåŒæ—¶æ»¡è¶³è¯¥èŠ‚ç‚¹å¹¶ä¸æ˜¯åªæœ‰ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹å·¦å³å­èŠ‚ç‚¹ï¼ˆä½œè€…è®¤ä¸ºè¿™ç§æƒ…å†µçš„ä¼˜åŒ–æ¶ˆè€—ä¼šå¤§äºæ”¶ç›Šï¼‰æ—¶ï¼Œæ ‡è®° "),a("code",[t._v("staticRoot")]),t._v(" ä¸º trueï¼Œå¦åˆ™ä¸º falseã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("markStaticRoots")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("static "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n        node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("staticRoot "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("staticRoot "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("4. optimize")])]),t._v(" "),a("p",[t._v("æœ‰äº†ä»¥ä¸Šçš„å‡½æ•°ï¼Œå°±å¯ä»¥å®ç° "),a("code",[t._v("optimize")]),t._v(" äº†ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function optimize (rootAst) {\n    markStatic(rootAst);\n    markStaticRoots(rootAst);\n}\n\n")])])]),a("h3",{attrs:{id:"generate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generate"}},[t._v("#")]),t._v(" generate")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("generate")]),t._v(" ä¼šå°† AST è½¬åŒ–æˆ render funtion å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆå¾—åˆ° render çš„å­—ç¬¦ä¸²ä»¥åŠ staticRenderFns å­—ç¬¦ä¸²ã€‚")])]),t._v(" "),a("p",[t._v("é¦–å…ˆå¸¦å¤§å®¶æ„Ÿå—ä¸€ä¸‹çœŸå®çš„ Vue.js ç¼–è¯‘å¾—åˆ°çš„ç»“æœã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isShow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_c")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            staticClass"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" c\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_l")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_c")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'span'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_v")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_s")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("çœ‹åˆ°è¿™é‡Œå¯èƒ½ä¼šçº³é—·äº†ï¼Œè¿™äº› "),a("code",[t._v("_c")]),t._v("ï¼Œ"),a("code",[t._v("_l")]),t._v(" åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå…¶å®ä»–ä»¬æ˜¯ Vue.js å¯¹ä¸€äº›å‡½æ•°çš„ç®€å†™ï¼Œæ¯”å¦‚è¯´ "),a("code",[t._v("_c")]),t._v(" å¯¹åº”çš„æ˜¯ "),a("code",[t._v("createElement")]),t._v(" è¿™ä¸ªå‡½æ•°ã€‚æ²¡å…³ç³»ï¼Œæˆ‘ä»¬æŠŠå®ƒç”¨ VNode çš„å½¢å¼å†™å‡ºæ¥å°±ä¼šæ˜ç™½äº†ï¼Œè¿™ä¸ªå¯¹æ¥ä¸Šä¸€ç« å†™çš„ VNode å‡½æ•°ã€‚")])]),t._v(" "),a("p",[t._v("é¦–å…ˆæ˜¯ç¬¬ä¸€å±‚ div èŠ‚ç‚¹ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" isShow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'staticClass'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'demo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'class'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" c\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*è¿™é‡Œè¿˜æœ‰å­èŠ‚ç‚¹*/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createEmptyVNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("ç„¶åæˆ‘ä»¬åœ¨ "),a("code",[t._v("children")]),t._v(" ä¸­åŠ ä¸Šç¬¬äºŒå±‚ span åŠå…¶å­æ–‡æœ¬èŠ‚ç‚¹èŠ‚ç‚¹ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* æ¸²æŸ“v-foråˆ—è¡¨ */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderList")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" l "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" isShow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'staticClass'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'demo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'class'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" c\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* begin */")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("VNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'span'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createTextVNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* end */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createEmptyVNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("é‚£æˆ‘ä»¬å¦‚ä½•æ¥å®ç°ä¸€ä¸ª "),a("code",[t._v("generate")]),t._v(" å‘¢ï¼Ÿ")]),t._v(" "),a("p",[a("strong",[t._v("1. genIf")])]),t._v(" "),a("p",[t._v("é¦–å…ˆå®ç°ä¸€ä¸ªå¤„ç† "),a("code",[t._v("if")]),t._v(" æ¡ä»¶çš„ "),a("code",[t._v("genIf")]),t._v(" å‡½æ•°ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genIf")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ifProcessed "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ifConditions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_e()'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ifConditions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exp"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(")?")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ifConditions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(": _e()")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("2. genFor")])]),t._v(" "),a("p",[t._v("ç„¶åæ˜¯å¤„ç† "),a("code",[t._v("for")]),t._v(" å¾ªç¯çš„å‡½æ•°ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genFor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("forProcessed "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" exp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" alias "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alias"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" iterator1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator1"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" iterator2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator2"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("_l((")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("exp"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("),")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("function(")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("alias"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("iterator1"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("iterator2"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("){")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("return ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'})'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("3. genText")])]),t._v(" "),a("p",[t._v("å¤„ç†æ–‡æœ¬èŠ‚ç‚¹çš„å‡½æ•°ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genText")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("_v(")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expression"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("4. genElement")])]),t._v(" "),a("ul",[a("li",[t._v("æ¥ä¸‹æ¥å®ç°ä¸€ä¸‹ "),a("code",[t._v("genElement")]),t._v("ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤„ç†èŠ‚ç‚¹çš„å‡½æ•°ï¼Œå› ä¸ºå®ƒä¾èµ– "),a("code",[t._v("genChildren")]),t._v(" ä»¥åŠg "),a("code",[t._v("enNode")]),t._v(" ï¼Œæ‰€ä»¥è¿™ä¸‰ä¸ªå‡½æ•°æ”¾åœ¨ä¸€èµ·è®²ã€‚")]),t._v(" "),a("li",[a("code",[t._v("genElement")]),t._v("ä¼šæ ¹æ®å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰ "),a("code",[t._v("if")]),t._v(" æˆ–è€… "),a("code",[t._v("for")]),t._v(" æ ‡è®°ç„¶ååˆ¤æ–­æ˜¯å¦è¦ç”¨ "),a("code",[t._v("genIf")]),t._v(" æˆ–è€… "),a("code",[t._v("genFor")]),t._v(" å¤„ç†ï¼Œå¦åˆ™é€šè¿‡ "),a("code",[t._v("genChildren")]),t._v(" å¤„ç†å­èŠ‚ç‚¹ï¼ŒåŒæ—¶å¾—åˆ° "),a("code",[t._v("staticClass")]),t._v("ã€"),a("code",[t._v("class")]),t._v(" ç­‰å±æ€§ã€‚")]),t._v(" "),a("li",[a("code",[t._v("genChildren")]),t._v(" æ¯”è¾ƒç®€å•ï¼Œéå†æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œé€šè¿‡ "),a("code",[t._v("genNode")]),t._v(" å¤„ç†åç”¨â€œï¼Œâ€éš”å¼€æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚")]),t._v(" "),a("li",[a("code",[t._v("genNode")]),t._v(" åˆ™æ˜¯æ ¹æ® "),a("code",[t._v("type")]),t._v(" æ¥åˆ¤æ–­è¯¥èŠ‚ç‚¹æ˜¯ç”¨æ–‡æœ¬èŠ‚ç‚¹ "),a("code",[t._v("genText")]),t._v(" è¿˜æ˜¯æ ‡ç­¾èŠ‚ç‚¹ "),a("code",[t._v("genElement")]),t._v(" æ¥å¤„ç†ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genNode")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genChildren")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("genNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("','")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genElement")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("if "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ifProcessed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genIf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("for "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("forProcessed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genFor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        code "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("_c('")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tag"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(",'{\n            staticClass: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrsMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':class'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(",\n            class: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrsMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrsMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'class'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(",\n        }")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("\n            children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("5. generate")])]),t._v(" "),a("blockquote",[a("p",[t._v("æœ€åæˆ‘ä»¬ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°æ¥å®ç° "),a("code",[t._v("generate")]),t._v("ï¼Œå…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ•´ä¸ª AST ä¼ å…¥ååˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™è¿”å›ä¸€ä¸ª div æ ‡ç­¾ï¼Œå¦åˆ™é€šè¿‡ "),a("code",[t._v("generate")]),t._v(" æ¥å¤„ç†ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function generate (rootAst) {\n    const code = rootAst ? genElement(rootAst) : '_c(\"div\")'\n    return {\n        render: `with(this){return ${code}}`,\n    }\n}\n\n")])])]),a("blockquote",[a("p",[t._v("ç»å†è¿‡è¿™äº›è¿‡ç¨‹ä»¥åï¼Œæˆ‘ä»¬å·²ç»æŠŠ template é¡ºåˆ©è½¬æˆäº† render function äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†ä»‹ç» "),a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹ï¼Œæ¥çœ‹ä¸€ä¸‹å…·ä½“ VNode èŠ‚ç‚¹å¦‚ä½•è¿›è¡Œå·®å¼‚çš„æ¯”å¯¹ã€‚")])]),t._v(" "),a("p",[t._v("æ³¨ï¼šæœ¬èŠ‚ä»£ç å‚è€ƒ"),a("a",{attrs:{href:"https://github.com/answershuto/VueDemo/blob/master/%E3%80%8Atemplate%20%E6%A8%A1%E6%9D%BF%E6%98%AF%E6%80%8E%E6%A0%B7%E9%80%9A%E8%BF%87%20Compile%20%E7%BC%96%E8%AF%91%E7%9A%84%E3%80%8B.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€Štemplate æ¨¡æ¿æ˜¯æ€æ ·é€šè¿‡ Compile ç¼–è¯‘çš„ã€‹"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"å…­ã€æ•°æ®çŠ¶æ€æ›´æ–°æ—¶çš„å·®å¼‚-diff-åŠ-patch-æœºåˆ¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…­ã€æ•°æ®çŠ¶æ€æ›´æ–°æ—¶çš„å·®å¼‚-diff-åŠ-patch-æœºåˆ¶"}},[t._v("#")]),t._v(" å…­ã€æ•°æ®çŠ¶æ€æ›´æ–°æ—¶çš„å·®å¼‚ diff åŠ patch æœºåˆ¶")]),t._v(" "),a("h3",{attrs:{id:"æ•°æ®æ›´æ–°è§†å›¾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®æ›´æ–°è§†å›¾"}},[t._v("#")]),t._v(" æ•°æ®æ›´æ–°è§†å›¾")]),t._v(" "),a("blockquote",[a("p",[t._v("ä¹‹å‰è®²åˆ°ï¼Œåœ¨å¯¹ "),a("code",[t._v("model")]),t._v(" è¿›è¡Œæ“ä½œå¯¹æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº” "),a("code",[t._v("Dep")]),t._v(" ä¸­çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ã€‚"),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ä¼šè°ƒç”¨å¯¹åº”çš„ "),a("code",[t._v("update")]),t._v(" æ¥ä¿®æ”¹è§†å›¾ã€‚æœ€ç»ˆæ˜¯å°†æ–°äº§ç”Ÿçš„ VNode èŠ‚ç‚¹ä¸è€ VNode è¿›è¡Œä¸€ä¸ª "),a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹ï¼Œæ¯”å¯¹å¾—å‡ºã€Œå·®å¼‚ã€ï¼Œæœ€ç»ˆå°†è¿™äº›ã€Œå·®å¼‚ã€æ›´æ–°åˆ°è§†å›¾ä¸Šã€‚")])]),t._v(" "),a("p",[t._v("è¿™ä¸€ç« å°±æ¥ä»‹ç»ä¸€ä¸‹è¿™ä¸ª "),a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹ï¼Œå› ä¸º "),a("code",[t._v("patch")]),t._v(" è¿‡ç¨‹æœ¬èº«æ¯”è¾ƒå¤æ‚ï¼Œè¿™ä¸€ç« çš„å†…å®¹ä¼šæ¯”è¾ƒå¤šï¼Œä½†æ˜¯ä¸è¦å®³æ€•ï¼Œæˆ‘ä»¬é€å—ä»£ç å»çœ‹ï¼Œä¸€å®šå¯ä»¥ç†è§£ã€‚")]),t._v(" "),a("h3",{attrs:{id:"è·¨å¹³å°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è·¨å¹³å°"}},[t._v("#")]),t._v(" è·¨å¹³å°")]),t._v(" "),a("blockquote",[a("p",[t._v("å› ä¸ºä½¿ç”¨äº† Virtual DOM çš„åŸå› ï¼ŒVue.jså…·æœ‰äº†è·¨å¹³å°çš„èƒ½åŠ›ï¼ŒVirtual DOM ç»ˆå½’åªæ˜¯ä¸€äº› JavaScript å¯¹è±¡ç½¢äº†ï¼Œé‚£ä¹ˆæœ€ç»ˆæ˜¯å¦‚ä½•è°ƒç”¨ä¸åŒå¹³å°çš„ API çš„å‘¢ï¼Ÿ")])]),t._v(" "),a("p",[t._v("è¿™å°±éœ€è¦ä¾èµ–ä¸€å±‚é€‚é…å±‚äº†ï¼Œå°†ä¸åŒå¹³å°çš„ API å°è£…åœ¨å†…ï¼Œä»¥åŒæ ·çš„æ¥å£å¯¹å¤–æä¾›ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" nodeOps "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("platform "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'weex'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parentNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAttr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'value'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("platform "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'web'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parentNode")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//......")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeChild")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//......")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextSibling")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//......")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//......")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("ä¸¾ä¸ªä¾‹å­ï¼Œç°åœ¨æˆ‘ä»¬æœ‰ä¸Šè¿°ä¸€ä¸ª "),a("code",[t._v("nodeOps")]),t._v(" å¯¹è±¡åšé€‚é…ï¼Œæ ¹æ® platform åŒºåˆ†ä¸åŒå¹³å°æ¥æ‰§è¡Œå½“å‰å¹³å°å¯¹åº”çš„APIï¼Œè€Œå¯¹å¤–åˆ™æ˜¯æä¾›äº†ä¸€è‡´çš„æ¥å£ï¼Œä¾› Virtual DOM æ¥è°ƒç”¨ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"ä¸€äº›api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€äº›api"}},[t._v("#")]),t._v(" ä¸€äº›API")]),t._v(" "),a("blockquote",[a("p",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä»‹ç»å…¶ä»–çš„ä¸€äº› APIï¼Œè¿™äº›APIåœ¨ä¸‹é¢ "),a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹ä¸­ä¼šè¢«ç”¨åˆ°ï¼Œä»–ä»¬æœ€ç»ˆéƒ½ä¼šè°ƒç”¨ "),a("code",[t._v("nodeOps")]),t._v(" ä¸­çš„ç›¸åº”å‡½æ•°æ¥æ“ä½œå¹³å°ã€‚")])]),t._v(" "),a("p",[a("code",[t._v("insert")]),t._v(" ç”¨æ¥åœ¨ "),a("code",[t._v("parent")]),t._v(" è¿™ä¸ªçˆ¶èŠ‚ç‚¹ä¸‹æ’å…¥ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œå¦‚æœæŒ‡å®šäº† "),a("code",[t._v("ref")]),t._v(" åˆ™æ’å…¥åˆ° "),a("code",[t._v("ref")]),t._v(" è¿™ä¸ªå­èŠ‚ç‚¹å‰é¢ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insert")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parentNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("code",[t._v("createElm")]),t._v(" ç”¨æ¥æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œ "),a("code",[t._v("tag")]),t._v(" å­˜åœ¨åˆ›å»ºä¸€ä¸ªæ ‡ç­¾èŠ‚ç‚¹ï¼Œå¦åˆ™åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("\nfunction createElm (vnode, parentElm, refElm) {\n    if (vnode.tag) {\n        insert(parentElm, nodeOps.createElement(vnode.tag), refElm);\n    } else {\n        insert(parentElm, nodeOps.createTextNode(vnode.text), refElm);\n    }\n}\n\n")])])]),a("p",[a("code",[t._v("addVnodes")]),t._v(" ç”¨æ¥æ‰¹é‡è°ƒç”¨ "),a("code",[t._v("createElm")]),t._v(" æ–°å»ºèŠ‚ç‚¹ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function addVnodes (parentElm, refElm, vnodes, startIdx, endIdx) {\n    for (; startIdx <= endIdx; ++startIdx) {\n        createElm(vnodes[startIdx], parentElm, refElm);\n    }\n}\n\n")])])]),a("p",[a("code",[t._v("removeNode")]),t._v(" ç”¨æ¥ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function removeNode (el) {\n    const parent = nodeOps.parentNode(el);\n    if (parent) {\n        nodeOps.removeChild(parent, el);\n    }\n}\n\n")])])]),a("p",[a("code",[t._v("removeVnodes")]),t._v(" ä¼šæ‰¹é‡è°ƒç”¨ "),a("code",[t._v("removeNode")]),t._v(" ç§»é™¤èŠ‚ç‚¹ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("function removeVnodes (parentElm, vnodes, startIdx, endIdx) {\n    for (; startIdx <= endIdx; ++startIdx) {\n        const ch = vnodes[startIdx]\n        if (ch) {\n            removeNode(ch.elm);\n        }\n    }\n}\n\n")])])]),a("h3",{attrs:{id:"patch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#patch"}},[t._v("#")]),t._v(" patch")]),t._v(" "),a("blockquote",[a("p",[t._v("é¦–å…ˆè¯´ä¸€ä¸‹ "),a("code",[t._v("patch")]),t._v(" çš„æ ¸å¿ƒ diff ç®—æ³•ï¼Œæˆ‘ä»¬ç”¨ diff ç®—æ³•å¯ä»¥æ¯”å¯¹å‡ºä¸¤é¢—æ ‘çš„ã€Œå·®å¼‚ã€ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰å¦‚ä¸‹ä¸¤é¢—æ ‘ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯æ–°è€ VNode èŠ‚ç‚¹ï¼Œè¿™æ—¶å€™åˆ°äº† "),a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦å°†ä»–ä»¬è¿›è¡Œæ¯”å¯¹ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/14.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("diff")]),t._v(" ç®—æ³•æ˜¯é€šè¿‡åŒå±‚çš„æ ‘èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒè€Œéå¯¹æ ‘è¿›è¡Œé€å±‚æœç´¢éå†çš„æ–¹å¼ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦åªæœ‰ "),a("code",[t._v("O(n)")]),t._v("ï¼Œæ˜¯ä¸€ç§ç›¸å½“é«˜æ•ˆçš„ç®—æ³•ï¼Œå¦‚ä¸‹å›¾ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/15.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("è¿™å¼ å›¾ä¸­çš„ç›¸åŒé¢œè‰²çš„æ–¹å—ä¸­çš„èŠ‚ç‚¹ä¼šè¿›è¡Œæ¯”å¯¹ï¼Œæ¯”å¯¹å¾—åˆ°ã€Œ"),a("strong",[t._v("å·®å¼‚")]),t._v("ã€åå°†è¿™äº›ã€Œ"),a("strong",[t._v("å·®å¼‚")]),t._v("ã€æ›´æ–°åˆ°è§†å›¾ä¸Šã€‚å› ä¸ºåªè¿›è¡ŒåŒå±‚çº§çš„æ¯”å¯¹ï¼Œæ‰€ä»¥ååˆ†é«˜æ•ˆã€‚")])]),t._v(" "),a("p",[a("code",[t._v("patch")]),t._v(" çš„è¿‡ç¨‹ç›¸å½“å¤æ‚ï¼Œæˆ‘ä»¬å…ˆç”¨ç®€å•çš„ä»£ç æ¥çœ‹ä¸€ä¸‹ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" parentElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("ul",[a("li",[t._v("å› ä¸º "),a("code",[t._v("patch")]),t._v(" çš„ä¸»è¦åŠŸèƒ½æ˜¯æ¯”å¯¹ä¸¤ä¸ª VNode èŠ‚ç‚¹ï¼Œå°†ã€Œå·®å¼‚ã€æ›´æ–°åˆ°è§†å›¾ä¸Šï¼Œæ‰€ä»¥å…¥å‚æœ‰æ–°è€ä¸¤ä¸ª VNode ä»¥åŠçˆ¶èŠ‚ç‚¹çš„ element ã€‚æˆ‘ä»¬æ¥é€æ­¥æ‹ä¸€ä¸‹é€»è¾‘ï¼Œ "),a("code",[t._v("addVnodes")]),t._v(" ã€ "),a("code",[t._v("removeVnodes")]),t._v(" ç­‰å‡½æ•°åé¢ä¼šè®²ã€‚")]),t._v(" "),a("li",[t._v("é¦–å…ˆåœ¨ "),a("code",[t._v("oldVnode")]),t._v("ï¼ˆè€ VNode èŠ‚ç‚¹ï¼‰ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œç›¸å½“äºæ–°çš„ VNode æ›¿ä»£åŸæœ¬æ²¡æœ‰çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ "),a("code",[t._v("addVnodes")]),t._v(" å°†è¿™äº›èŠ‚ç‚¹æ‰¹é‡æ·»åŠ åˆ° "),a("code",[t._v("parentElm")]),t._v(" ä¸Šã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("ç„¶ååŒç†ï¼Œåœ¨ "),a("code",[t._v("vnode")]),t._v("ï¼ˆæ–° VNode èŠ‚ç‚¹ï¼‰ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œç›¸å½“äºè¦æŠŠè€çš„èŠ‚ç‚¹åˆ é™¤ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨ "),a("code",[t._v("removeVnodes")]),t._v(" è¿›è¡Œæ‰¹é‡çš„èŠ‚ç‚¹åˆ é™¤å³å¯ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("æœ€åä¸€ç§æƒ…å†µï¼Œå½“ "),a("code",[t._v("oldVNode")]),t._v(" ä¸ "),a("code",[t._v("vnode")]),t._v(" éƒ½å­˜åœ¨çš„æ—¶å€™ï¼Œéœ€è¦åˆ¤æ–­å®ƒä»¬æ˜¯å¦å±äº "),a("code",[t._v("sameVnode")]),t._v("ï¼ˆç›¸åŒçš„èŠ‚ç‚¹ï¼‰ã€‚å¦‚æœæ˜¯åˆ™è¿›è¡ŒpatchVnodeï¼ˆæ¯”å¯¹ VNode ï¼‰æ“ä½œï¼Œå¦åˆ™åˆ é™¤è€èŠ‚ç‚¹ï¼Œå¢åŠ æ–°èŠ‚ç‚¹ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"samevnode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#samevnode"}},[t._v("#")]),t._v(" sameVnode")]),t._v(" "),a("p",[t._v("ä¸Šé¢è¿™äº›æ¯”è¾ƒå¥½ç†è§£ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ä»€ä¹ˆæƒ…å†µä¸‹ä¸¤ä¸ª VNode ä¼šå±äº "),a("code",[t._v("sameVnode")]),t._v(" ï¼ˆç›¸åŒçš„èŠ‚ç‚¹ï¼‰å‘¢ï¼Ÿ")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n        a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n        a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isComment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isComment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameInputType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameInputType")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'input'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" typeA "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" typeB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" typeA "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" typeB\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[a("code",[t._v("sameVnode")]),t._v(" å…¶å®å¾ˆç®€å•ï¼Œåªæœ‰å½“ "),a("code",[t._v("key")]),t._v("ã€ "),a("code",[t._v("tag")]),t._v("ã€ "),a("code",[t._v("isComment")]),t._v("ï¼ˆæ˜¯å¦ä¸ºæ³¨é‡ŠèŠ‚ç‚¹ï¼‰ã€ "),a("code",[t._v("data")]),t._v("åŒæ—¶å®šä¹‰ï¼ˆæˆ–ä¸å®šä¹‰ï¼‰ï¼ŒåŒæ—¶æ»¡è¶³å½“æ ‡ç­¾ç±»å‹ä¸º input çš„æ—¶å€™ type ç›¸åŒï¼ˆæŸäº›æµè§ˆå™¨ä¸æ”¯æŒåŠ¨æ€ä¿®æ”¹"),a("input"),t._v("ç±»å‹ï¼Œæ‰€ä»¥ä»–ä»¬è¢«è§†ä¸ºä¸åŒç±»å‹ï¼‰å³å¯ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"patchvnode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#patchvnode"}},[t._v("#")]),t._v(" patchVnode")]),t._v(" "),a("blockquote",[a("p",[t._v("ä¹‹å‰patchçš„è¿‡ç¨‹è¿˜å‰©ä¸‹ "),a("code",[t._v("patchVnode")]),t._v(" è¿™ä¸ªå‡½æ•°æ²¡æœ‰è®²ï¼Œè¿™ä¹Ÿæ˜¯æœ€å¤æ‚çš„ä¸€ä¸ªï¼Œæˆ‘ä»¬ç°åœ¨æ¥çœ‹ä¸€ä¸‹ã€‚å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯åœ¨ç¬¦åˆ "),a("code",[t._v("sameVnode")]),t._v(" çš„æ¡ä»¶ä¸‹è§¦å‘çš„ï¼Œæ‰€ä»¥ä¼šè¿›è¡Œã€Œ"),a("strong",[t._v("æ¯”å¯¹")]),t._v("ã€ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isStatic "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isStatic "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("componentInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("componentInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" oldCh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" ch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("é¦–å…ˆåœ¨æ–°è€ "),a("code",[t._v("VNode")]),t._v("èŠ‚ç‚¹ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œå°±ä¸éœ€è¦åšä»»ä½•æ”¹å˜äº†ï¼Œç›´æ¥ "),a("code",[t._v("return")]),t._v(" æ‰ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("ä¸‹é¢çš„è¿™ç§æƒ…å†µä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåœ¨å½“æ–°è€ VNode èŠ‚ç‚¹éƒ½æ˜¯ "),a("code",[t._v("isStatic")]),t._v("ï¼ˆé™æ€çš„ï¼‰ï¼Œå¹¶ä¸” "),a("code",[t._v("key")]),t._v(" ç›¸åŒæ—¶ï¼Œåªè¦å°† "),a("code",[t._v("componentInstance")]),t._v(" ä¸ "),a("code",[t._v("elm")]),t._v(" ä»è€ VNode èŠ‚ç‚¹â€œæ‹¿è¿‡æ¥â€å³å¯ã€‚è¿™é‡Œçš„ "),a("code",[t._v("isStatic")]),t._v(" ä¹Ÿå°±æ˜¯å‰é¢æåˆ°è¿‡çš„ã€Œç¼–è¯‘ã€çš„æ—¶å€™ä¼šå°†é™æ€èŠ‚ç‚¹æ ‡è®°å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥è·³è¿‡æ¯”å¯¹çš„è¿‡ç¨‹ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isStatic "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isStatic "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("componentInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("componentInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("æ¥ä¸‹æ¥ï¼Œå½“æ–° VNode èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹çš„æ—¶å€™ï¼Œç›´æ¥ç”¨ "),a("code",[t._v("setTextContent")]),t._v(" æ¥è®¾ç½® textï¼Œè¿™é‡Œçš„ "),a("code",[t._v("nodeOps")]),t._v(" æ˜¯ä¸€ä¸ªé€‚é…å±‚ï¼Œæ ¹æ®ä¸åŒå¹³å°æä¾›ä¸åŒçš„æ“ä½œå¹³å° DOM çš„æ–¹æ³•ï¼Œå®ç°è·¨å¹³å°ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("å½“æ–° VNode èŠ‚ç‚¹æ˜¯éæ–‡æœ¬èŠ‚ç‚¹å½“æ—¶å€™ï¼Œéœ€è¦åˆ†å‡ ç§æƒ…å†µ")]),t._v("ã€‚")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("oldCh")]),t._v(" ä¸ "),a("code",[t._v("ch")]),t._v(" éƒ½å­˜åœ¨ä¸”ä¸ç›¸åŒæ—¶ï¼Œä½¿ç”¨ "),a("code",[t._v("updateChildren")]),t._v(" å‡½æ•°æ¥æ›´æ–°å­èŠ‚ç‚¹ï¼Œè¿™ä¸ªåé¢é‡ç‚¹è®²ã€‚")]),t._v(" "),a("li",[t._v("å¦‚æœåªæœ‰ "),a("code",[t._v("ch")]),t._v(" å­˜åœ¨çš„æ—¶å€™ï¼Œå¦‚æœè€èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹åˆ™å…ˆå°†èŠ‚ç‚¹çš„æ–‡æœ¬æ¸…é™¤ï¼Œç„¶åå°† "),a("code",[t._v("ch")]),t._v(" æ‰¹é‡æ’å…¥æ’å…¥åˆ°èŠ‚ç‚¹elmä¸‹ã€‚")]),t._v(" "),a("li",[t._v("åŒç†å½“åªæœ‰ "),a("code",[t._v("oldch")]),t._v(" å­˜åœ¨æ—¶ï¼Œè¯´æ˜éœ€è¦å°†è€èŠ‚ç‚¹é€šè¿‡ "),a("code",[t._v("removeVnodes")]),t._v(" å…¨éƒ¨æ¸…é™¤ã€‚")]),t._v(" "),a("li",[t._v("æœ€åä¸€ç§æƒ…å†µæ˜¯å½“åªæœ‰è€èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ¸…é™¤å…¶èŠ‚ç‚¹æ–‡æœ¬å†…å®¹ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" ch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"updatechildren"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#updatechildren"}},[t._v("#")]),t._v(" updateChildren")]),t._v(" "),a("blockquote",[a("p",[t._v("æ¥ä¸‹æ¥å°±è¦è®²ä¸€ä¸‹ "),a("code",[t._v("updateChildren")]),t._v(" å‡½æ•°äº†ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateChildren")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newCh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldKeyToIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" refElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" oldEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" newStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextSibling")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" elmToMove "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("oldKeyToIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" oldKeyToIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createKeyToOldIdx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            idxInOld "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" oldKeyToIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                elmToMove "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        refElm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" refElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("ul",[a("li",[t._v("çœ‹åˆ°ä»£ç é‚£ä¹ˆå¤šå…ˆä¸è¦ç€æ€¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸€ç‚¹ä¸€ç‚¹åœ°è®²è§£ã€‚")]),t._v(" "),a("li",[t._v("é¦–å…ˆæˆ‘ä»¬å®šä¹‰ "),a("code",[t._v("oldStartIdx")]),t._v("ã€"),a("code",[t._v("newStartIdx")]),t._v("ã€"),a("code",[t._v("oldEndIdx")]),t._v(" ä»¥åŠ "),a("code",[t._v("newEndIdx")]),t._v(" åˆ†åˆ«æ˜¯æ–°è€ä¸¤ä¸ª VNode çš„ä¸¤è¾¹çš„ç´¢å¼•ï¼ŒåŒæ—¶ "),a("code",[t._v("oldStartVnode")]),t._v("ã€"),a("code",[t._v("newStartVnode")]),t._v("ã€"),a("code",[t._v("oldEndVnode")]),t._v(" ä»¥åŠ "),a("code",[t._v("newEndVnode")]),t._v(" åˆ†åˆ«æŒ‡å‘è¿™å‡ ä¸ªç´¢å¼•å¯¹åº”çš„ VNode èŠ‚ç‚¹ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/16.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ª "),a("code",[t._v("while")]),t._v(" å¾ªç¯ï¼Œåœ¨è¿™è¿‡ç¨‹ä¸­ï¼Œ"),a("code",[t._v("oldStartIdx")]),t._v("ã€"),a("code",[t._v("newStartIdx")]),t._v("ã€"),a("code",[t._v("oldEndIdx")]),t._v(" ä»¥åŠ "),a("code",[t._v("newEndIdx")]),t._v(" ä¼šé€æ¸å‘ä¸­é—´é æ‹¢ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) \n\n")])])]),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/17.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("é¦–å…ˆå½“ "),a("code",[t._v("oldStartVnode")]),t._v(" æˆ–è€… "),a("code",[t._v("oldEndVnode")]),t._v(" ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œ"),a("code",[t._v("oldStartIdx")]),t._v(" ä¸ "),a("code",[t._v("oldEndIdx")]),t._v(" ç»§ç»­å‘ä¸­é—´é æ‹¢ï¼Œå¹¶æ›´æ–°å¯¹åº”çš„ "),a("code",[t._v("oldStartVnode")]),t._v(" ä¸ "),a("code",[t._v("oldEndVnode")]),t._v(" çš„æŒ‡å‘ï¼ˆæ³¨ï¼šä¸‹é¢è®²åˆ°çš„ "),a("code",[t._v("oldStartIdx")]),t._v("ã€"),a("code",[t._v("newStartIdx")]),t._v("ã€"),a("code",[t._v("oldEndIdx")]),t._v(" ä»¥åŠ "),a("code",[t._v("newEndIdx")]),t._v(" ç§»åŠ¨éƒ½ä¼šä¼´éšç€ "),a("code",[t._v("oldStartVnode")]),t._v("ã€"),a("code",[t._v("newStartVnode")]),t._v("ã€"),a("code",[t._v("oldEndVnode")]),t._v(" ä»¥åŠ "),a("code",[t._v("newEndVnode")]),t._v(" çš„æŒ‡å‘çš„å˜åŒ–ï¼Œä¹‹åçš„éƒ¨åˆ†åªä¼šè®² "),a("code",[t._v("Idx")]),t._v(" çš„ç§»åŠ¨ï¼‰ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("æ¥ä¸‹æ¥è¿™ä¸€å—ï¼Œæ˜¯å°† "),a("code",[t._v("oldStartIdx")]),t._v("ã€"),a("code",[t._v("newStartIdx")]),t._v("ã€"),a("code",[t._v("oldEndIdx")]),t._v(" ä»¥åŠ "),a("code",[t._v("newEndIdx")]),t._v(" ä¸¤ä¸¤æ¯”å¯¹çš„è¿‡ç¨‹ï¼Œä¸€å…±ä¼šå‡ºç° 2*2=4 ç§æƒ…å†µã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextSibling")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n\n")])])]),a("blockquote",[a("p",[t._v("é¦–å…ˆæ˜¯ "),a("code",[t._v("oldStartVnode")]),t._v(" ä¸ "),a("code",[t._v("newStartVnode")]),t._v(" ç¬¦åˆ "),a("code",[t._v("sameVnode")]),t._v(" æ—¶ï¼Œè¯´æ˜è€ VNode èŠ‚ç‚¹çš„å¤´éƒ¨ä¸æ–° VNode èŠ‚ç‚¹çš„å¤´éƒ¨æ˜¯ç›¸åŒçš„ VNode èŠ‚ç‚¹ï¼Œç›´æ¥è¿›è¡Œ "),a("code",[t._v("patchVnode")]),t._v("ï¼ŒåŒæ—¶ "),a("code",[t._v("oldStartIdx")]),t._v(" ä¸ "),a("code",[t._v("newStartIdx")]),t._v(" å‘åç§»åŠ¨ä¸€ä½ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/18.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("å…¶æ¬¡æ˜¯ "),a("code",[t._v("oldEndVnode")]),t._v(" ä¸ "),a("code",[t._v("newEndVnode")]),t._v(" ç¬¦åˆ "),a("code",[t._v("sameVnode")]),t._v("ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ª VNode çš„ç»“å°¾æ˜¯ç›¸åŒçš„ VNodeï¼ŒåŒæ ·è¿›è¡Œ "),a("code",[t._v("patchVnode")]),t._v(" æ“ä½œå¹¶å°† "),a("code",[t._v("oldEndVnode")]),t._v(" ä¸ "),a("code",[t._v("newEndVnode")]),t._v(" å‘å‰ç§»åŠ¨ä¸€ä½ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/19.png",alt:""}})]),t._v(" "),a("p",[a("strong",[t._v("æ¥ä¸‹æ¥æ˜¯ä¸¤ç§äº¤å‰çš„æƒ…å†µ")]),t._v("ã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("å…ˆæ˜¯ "),a("code",[t._v("oldStartVnode")]),t._v(" ä¸ "),a("code",[t._v("newEndVnode")]),t._v(" ç¬¦åˆ "),a("code",[t._v("sameVnode")]),t._v(" çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯è€ VNode èŠ‚ç‚¹çš„å¤´éƒ¨ä¸æ–° VNode èŠ‚ç‚¹çš„å°¾éƒ¨æ˜¯åŒä¸€èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå°† "),a("code",[t._v("oldStartVnode.elm")]),t._v(" è¿™ä¸ªèŠ‚ç‚¹ç›´æ¥ç§»åŠ¨åˆ° "),a("code",[t._v("oldEndVnode.elm")]),t._v(" è¿™ä¸ªèŠ‚ç‚¹çš„åé¢å³å¯ã€‚ç„¶å "),a("code",[t._v("oldStartIdx")]),t._v(" å‘åç§»åŠ¨ä¸€ä½ï¼Œ"),a("code",[t._v("newEndIdx")]),t._v(" å‘å‰ç§»åŠ¨ä¸€ä½ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/20.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("åŒç†ï¼Œ"),a("code",[t._v("oldEndVnode")]),t._v(" ä¸ "),a("code",[t._v("newStartVnode")]),t._v(" ç¬¦åˆ "),a("code",[t._v("sameVnode")]),t._v(" æ—¶ï¼Œä¹Ÿå°±æ˜¯è€ VNode èŠ‚ç‚¹çš„å°¾éƒ¨ä¸æ–° VNode èŠ‚ç‚¹çš„å¤´éƒ¨æ˜¯åŒä¸€èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå°† "),a("code",[t._v("oldEndVnode.elm")]),t._v(" æ’å…¥åˆ° "),a("code",[t._v("oldStartVnode.elm")]),t._v(" å‰é¢ã€‚åŒæ ·çš„ï¼Œ"),a("code",[t._v("oldEndIdx")]),t._v(" å‘å‰ç§»åŠ¨ä¸€ä½ï¼Œ"),a("code",[t._v("newStartIdx")]),t._v(" å‘åç§»åŠ¨ä¸€ä½ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/21.png",alt:""}})]),t._v(" "),a("p",[t._v("æœ€åæ˜¯å½“ä»¥ä¸Šæƒ…å†µéƒ½ä¸ç¬¦åˆçš„æ—¶å€™ï¼Œè¿™ç§æƒ…å†µæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" elmToMove "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("oldKeyToIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" oldKeyToIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createKeyToOldIdx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    idxInOld "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" oldKeyToIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        elmToMove "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createKeyToOldIdx")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" beginIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" endIdx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" map "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" beginIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" endIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" map\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[a("code",[t._v("createKeyToOldIdx")]),t._v(" çš„ä½œç”¨æ˜¯äº§ç”Ÿ "),a("code",[t._v("key")]),t._v(" ä¸ "),a("code",[t._v("index")]),t._v(" ç´¢å¼•å¯¹åº”çš„ä¸€ä¸ª map è¡¨ã€‚æ¯”å¦‚è¯´ï¼š")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("[\n    {xx: xx, key: 'key0'},\n    {xx: xx, key: 'key1'}, \n    {xx: xx, key: 'key2'}\n]\n\n")])])]),a("blockquote",[a("p",[t._v("åœ¨ç»è¿‡ "),a("code",[t._v("createKeyToOldIdx")]),t._v(" è½¬åŒ–ä»¥åä¼šå˜æˆï¼š")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("{\n    key0: 0, \n    key1: 1, \n    key2: 2\n}\n\n")])])]),a("blockquote",[a("p",[t._v("æˆ‘ä»¬å¯ä»¥æ ¹æ®æŸä¸€ä¸ª key çš„å€¼ï¼Œå¿«é€Ÿåœ°ä» "),a("code",[t._v("oldKeyToIdx")]),t._v("ï¼ˆ"),a("code",[t._v("createKeyToOldIdx")]),t._v(" çš„è¿”å›å€¼ï¼‰ä¸­è·å–ç›¸åŒ key çš„èŠ‚ç‚¹çš„ç´¢å¼• "),a("code",[t._v("idxInOld")]),t._v("ï¼Œç„¶åæ‰¾åˆ°ç›¸åŒçš„èŠ‚ç‚¹ã€‚")])]),t._v(" "),a("p",[t._v("å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç›¸åŒçš„èŠ‚ç‚¹ï¼Œåˆ™é€šè¿‡ "),a("code",[t._v("createElm")]),t._v(" åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå¹¶å°† "),a("code",[t._v("newStartIdx")]),t._v(" å‘åç§»åŠ¨ä¸€ä½ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("å¦åˆ™å¦‚æœæ‰¾åˆ°äº†èŠ‚ç‚¹ï¼ŒåŒæ—¶å®ƒç¬¦åˆ "),a("code",[t._v("sameVnode")]),t._v("ï¼Œåˆ™å°†è¿™ä¸¤ä¸ªèŠ‚ç‚¹è¿›è¡Œ "),a("code",[t._v("patchVnode")]),t._v("ï¼Œå°†è¯¥ä½ç½®çš„è€èŠ‚ç‚¹èµ‹å€¼ undefinedï¼ˆä¹‹åå¦‚æœè¿˜æœ‰æ–°èŠ‚ç‚¹ä¸è¯¥èŠ‚ç‚¹keyç›¸åŒå¯ä»¥æ£€æµ‹å‡ºæ¥æç¤ºå·²æœ‰é‡å¤çš„ key ï¼‰ï¼ŒåŒæ—¶å°† "),a("code",[t._v("newStartVnode.elm")]),t._v(" æ’å…¥åˆ° "),a("code",[t._v("oldStartVnode.elm")]),t._v(" çš„å‰é¢ã€‚åŒç†ï¼Œ"),a("code",[t._v("newStartIdx")]),t._v(" å¾€åç§»åŠ¨ä¸€ä½ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/22.png",alt:""}})]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    elmToMove "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        nodeOps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("å¦‚æœä¸ç¬¦åˆ "),a("code",[t._v("sameVnode")]),t._v("ï¼Œåªèƒ½åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹æ’å…¥åˆ° "),a("code",[t._v("parentElm")]),t._v(" çš„å­èŠ‚ç‚¹ä¸­ï¼Œ"),a("code",[t._v("newStartIdx")]),t._v(" å¾€åç§»åŠ¨ä¸€ä½ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/23.png",alt:""}})]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("æœ€åä¸€æ­¥å°±å¾ˆå®¹æ˜“å•¦ï¼Œå½“ "),a("code",[t._v("while")]),t._v(" å¾ªç¯ç»“æŸä»¥åï¼Œå¦‚æœ "),a("code",[t._v("oldStartIdx > oldEndIdx")]),t._v("ï¼Œè¯´æ˜è€èŠ‚ç‚¹æ¯”å¯¹å®Œäº†ï¼Œä½†æ˜¯æ–°èŠ‚ç‚¹è¿˜æœ‰å¤šçš„ï¼Œéœ€è¦å°†æ–°èŠ‚ç‚¹æ’å…¥åˆ°çœŸå® DOM ä¸­å»ï¼Œè°ƒç”¨ "),a("code",[t._v("addVnodes")]),t._v(" å°†è¿™äº›èŠ‚ç‚¹æ’å…¥å³å¯ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/24.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("åŒç†ï¼Œå¦‚æœæ»¡è¶³ "),a("code",[t._v("newStartIdx > newEndIdx")]),t._v(" æ¡ä»¶ï¼Œè¯´æ˜æ–°èŠ‚ç‚¹æ¯”å¯¹å®Œäº†ï¼Œè€èŠ‚ç‚¹è¿˜æœ‰å¤šï¼Œå°†è¿™äº›æ— ç”¨çš„è€èŠ‚ç‚¹é€šè¿‡ "),a("code",[t._v("removeVnodes")]),t._v(" æ‰¹é‡åˆ é™¤å³å¯ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/25.png",alt:""}})]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    refElm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" refElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("åˆ°è¿™é‡Œï¼Œæ¯”å¯¹çš„æ ¸å¿ƒå®ç°å·²ç»è®²å®Œäº†ï¼Œè¿™éƒ¨åˆ†æ¯”è¾ƒå¤æ‚ï¼Œä¸è¿‡ä»”ç»†åœ°æ¢³ç†ä¸€ä¸‹æ¯”å¯¹çš„è¿‡ç¨‹ï¼Œç›¸ä¿¡ä¸€å®šèƒ½å¤Ÿç†è§£å¾—æ›´åŠ é€å½»çš„ã€‚")])]),t._v(" "),a("p",[t._v("æ³¨ï¼šæœ¬èŠ‚ä»£ç å‚è€ƒ"),a("a",{attrs:{href:"https://github.com/answershuto/VueDemo/blob/master/%E3%80%8A%E6%95%B0%E6%8D%AE%E7%8A%B6%E6%80%81%E6%9B%B4%E6%96%B0%E6%97%B6%E7%9A%84%E5%B7%AE%E5%BC%82%20diff%20%E5%8F%8A%20patch%20%E6%9C%BA%E5%88%B6%E3%80%8B.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€Šæ•°æ®çŠ¶æ€æ›´æ–°æ—¶çš„å·®å¼‚ diff åŠ patch æœºåˆ¶ã€‹"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"ä¸ƒã€æ‰¹é‡å¼‚æ­¥æ›´æ–°ç­–ç•¥åŠ-nexttick-åŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ƒã€æ‰¹é‡å¼‚æ­¥æ›´æ–°ç­–ç•¥åŠ-nexttick-åŸç†"}},[t._v("#")]),t._v(" ä¸ƒã€æ‰¹é‡å¼‚æ­¥æ›´æ–°ç­–ç•¥åŠ nextTick åŸç†")]),t._v(" "),a("h3",{attrs:{id:"ä¸ºä»€ä¹ˆè¦å¼‚æ­¥æ›´æ–°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆè¦å¼‚æ­¥æ›´æ–°"}},[t._v("#")]),t._v(" ä¸ºä»€ä¹ˆè¦å¼‚æ­¥æ›´æ–°")]),t._v(" "),a("blockquote",[a("p",[t._v("é€šè¿‡å‰é¢å‡ ä¸ªç« èŠ‚æˆ‘ä»¬ä»‹ç»ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»æ˜ç™½äº† Vue.js æ˜¯å¦‚ä½•åœ¨æˆ‘ä»¬ä¿®æ”¹ "),a("code",[t._v("data")]),t._v(" ä¸­çš„æ•°æ®åä¿®æ”¹è§†å›¾äº†ã€‚ç®€å•å›é¡¾ä¸€ä¸‹ï¼Œè¿™é‡Œé¢å…¶å®å°±æ˜¯ä¸€ä¸ªâ€œ"),a("code",[t._v("setter -> Dep -> Watcher -> patch -> è§†å›¾")]),t._v("â€çš„è¿‡ç¨‹ã€‚")])]),t._v(" "),a("p",[t._v("å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹è¿™ä¹ˆä¸€ç§æƒ…å†µã€‚")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{number}}"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@click")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("handleClick"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("click"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            number"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleClick")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("number"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("å½“æˆ‘ä»¬æŒ‰ä¸‹ "),a("code",[t._v("click")]),t._v(" æŒ‰é’®çš„æ—¶å€™ï¼Œ"),a("code",[t._v("number")]),t._v(" ä¼šè¢«å¾ªç¯å¢åŠ 1000æ¬¡ã€‚")]),t._v(" "),a("p",[t._v("é‚£ä¹ˆæŒ‰ç…§ä¹‹å‰çš„ç†è§£ï¼Œæ¯æ¬¡ "),a("code",[t._v("number")]),t._v(" è¢« +1 çš„æ—¶å€™ï¼Œéƒ½ä¼šè§¦å‘ "),a("code",[t._v("number")]),t._v(" çš„ "),a("code",[t._v("setter")]),t._v(" æ–¹æ³•ï¼Œä»è€Œæ ¹æ®ä¸Šé¢çš„æµç¨‹ä¸€ç›´è·‘ä¸‹æ¥æœ€åä¿®æ”¹çœŸå® DOMã€‚é‚£ä¹ˆåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒDOM ä¼šè¢«æ›´æ–° 1000 æ¬¡ï¼å¤ªå¯æ€•äº†ã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("Vue.js è‚¯å®šä¸ä¼šä»¥å¦‚æ­¤ä½æ•ˆçš„æ–¹æ³•æ¥å¤„ç†ã€‚Vue.jsåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯æ¬¡è§¦å‘æŸä¸ªæ•°æ®çš„ "),a("code",[t._v("setter")]),t._v(" æ–¹æ³•åï¼Œå¯¹åº”çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡å…¶å®ä¼šè¢« "),a("code",[t._v("push")]),t._v(" è¿›ä¸€ä¸ªé˜Ÿåˆ— "),a("code",[t._v("queue")]),t._v(" ä¸­ï¼Œåœ¨ä¸‹ä¸€ä¸ª tick çš„æ—¶å€™å°†è¿™ä¸ªé˜Ÿåˆ— "),a("code",[t._v("queue")]),t._v(" å…¨éƒ¨æ‹¿å‡ºæ¥ "),a("code",[t._v("run")]),t._v("ï¼ˆ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥è§¦å‘ "),a("code",[t._v("patch")]),t._v(" æ“ä½œï¼‰ ä¸€éã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/26.png",alt:""}})]),t._v(" "),a("p",[t._v("é‚£ä¹ˆä»€ä¹ˆæ˜¯ä¸‹ä¸€ä¸ª tick å‘¢ï¼Ÿ")]),t._v(" "),a("h3",{attrs:{id:"nexttick"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nexttick"}},[t._v("#")]),t._v(" nextTick")]),t._v(" "),a("blockquote",[a("p",[t._v("Vue.js å®ç°äº†ä¸€ä¸ª "),a("code",[t._v("nextTick")]),t._v(" å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ª "),a("code",[t._v("cb")]),t._v(" ï¼Œè¿™ä¸ª "),a("code",[t._v("cb")]),t._v(" ä¼šè¢«å­˜å‚¨åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œåœ¨ä¸‹ä¸€ä¸ª tick æ—¶è§¦å‘é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ "),a("code",[t._v("cb")]),t._v(" äº‹ä»¶ã€‚")])]),t._v(" "),a("ul",[a("li",[t._v("å› ä¸ºç›®å‰æµè§ˆå™¨å¹³å°å¹¶æ²¡æœ‰å®ç° "),a("code",[t._v("nextTick")]),t._v(" æ–¹æ³•ï¼Œæ‰€ä»¥ Vue.js æºç ä¸­åˆ†åˆ«ç”¨ "),a("code",[t._v("Promise")]),t._v("ã€"),a("code",[t._v("setTimeout")]),t._v("ã€"),a("code",[t._v("setImmediate")]),t._v(" ç­‰æ–¹å¼åœ¨ microtaskï¼ˆæˆ–æ˜¯taskï¼‰ä¸­åˆ›å»ºä¸€ä¸ªäº‹ä»¶ï¼Œç›®çš„æ˜¯åœ¨å½“å‰è°ƒç”¨æ ˆæ‰§è¡Œå®Œæ¯•ä»¥åï¼ˆä¸ä¸€å®šç«‹å³ï¼‰æ‰ä¼šå»æ‰§è¡Œè¿™ä¸ªäº‹ä»¶ã€‚")]),t._v(" "),a("li",[t._v("ç¬”è€…ç”¨ "),a("code",[t._v("setTimeout")]),t._v(" æ¥æ¨¡æ‹Ÿè¿™ä¸ªæ–¹æ³•ï¼Œå½“ç„¶ï¼ŒçœŸå®çš„æºç ä¸­ä¼šæ›´åŠ å¤æ‚ï¼Œç¬”è€…åœ¨å°å†Œä¸­åªè®²åŸç†ï¼Œæœ‰å…´è¶£äº†è§£æºç ä¸­ "),a("code",[t._v("nextTick")]),t._v(" çš„å…·ä½“å®ç°çš„åŒå­¦å¯ä»¥å‚è€ƒ"),a("a",{attrs:{href:"https://github.com/vuejs/vue/blob/dev/src/core/util/next-tick.js#L90",target:"_blank",rel:"noopener noreferrer"}},[t._v("next-tick"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("li",[t._v("é¦–å…ˆå®šä¹‰ä¸€ä¸ª "),a("code",[t._v("callbacks")]),t._v(" æ•°ç»„ç”¨æ¥å­˜å‚¨ "),a("code",[t._v("nextTick")]),t._v("ï¼Œåœ¨ä¸‹ä¸€ä¸ª "),a("code",[t._v("tick")]),t._v(" å¤„ç†è¿™äº›å›è°ƒå‡½æ•°ä¹‹å‰ï¼Œæ‰€æœ‰çš„ "),a("code",[t._v("cb")]),t._v(" éƒ½ä¼šè¢«å­˜åœ¨è¿™ä¸ª "),a("code",[t._v("callbacks")]),t._v(" æ•°ç»„ä¸­ã€‚"),a("code",[t._v("pending")]),t._v(" æ˜¯ä¸€ä¸ªæ ‡è®°ä½ï¼Œä»£è¡¨ä¸€ä¸ªç­‰å¾…çš„çŠ¶æ€ã€‚")]),t._v(" "),a("li",[a("code",[t._v("setTimeout")]),t._v(" ä¼šåœ¨ task ä¸­åˆ›å»ºä¸€ä¸ªäº‹ä»¶ "),a("code",[t._v("flushCallbacks")]),t._v(" ï¼Œ"),a("code",[t._v("flushCallbacks")]),t._v(" åˆ™ä¼šåœ¨æ‰§è¡Œæ—¶å°† "),a("code",[t._v("callbacks")]),t._v(" ä¸­çš„æ‰€æœ‰ "),a("code",[t._v("cb")]),t._v(" ä¾æ¬¡æ‰§è¡Œã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" callbacks "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" pending "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    callbacks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("pending"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        pending "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flushCallbacks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("flushCallbacks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    pending "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" copies "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callbacks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    callbacks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" copies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        copies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"å†å†™-watcher"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å†å†™-watcher"}},[t._v("#")]),t._v(" å†å†™ Watcher")]),t._v(" "),a("ul",[a("li",[t._v("ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œå½“æˆ‘ä»¬å°† "),a("code",[t._v("number")]),t._v(" å¢åŠ  1000 æ¬¡æ—¶ï¼Œå…ˆå°†å¯¹åº”çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ç»™ "),a("code",[t._v("push")]),t._v(" è¿›ä¸€ä¸ªé˜Ÿåˆ— "),a("code",[t._v("queue")]),t._v(" ä¸­å»ï¼Œç­‰ä¸‹ä¸€ä¸ª tick çš„æ—¶å€™å†å»æ‰§è¡Œï¼Œè¿™æ ·åšæ˜¯å¯¹çš„ã€‚ä½†æ˜¯æœ‰æ²¡æœ‰å‘ç°ï¼Œå¦ä¸€ä¸ªé—®é¢˜å‡ºç°äº†ï¼Ÿ")]),t._v(" "),a("li",[t._v("å› ä¸º "),a("code",[t._v("number")]),t._v(" æ‰§è¡Œ ++ æ“ä½œä»¥åå¯¹åº”çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦åœ¨ä¸‹ä¸€ä¸ª tick çš„æ—¶å€™æ‰§è¡Œ 1000 ä¸ªåŒæ ·çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡å»ä¿®æ”¹ç•Œé¢ï¼Œè€Œæ˜¯åªéœ€è¦æ‰§è¡Œä¸€ä¸ª "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ï¼Œä½¿å…¶å°†ç•Œé¢ä¸Šçš„ 0 å˜æˆ 1000 å³å¯ã€‚")]),t._v(" "),a("li",[t._v("é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰§è¡Œä¸€ä¸ªè¿‡æ»¤çš„æ“ä½œï¼ŒåŒä¸€ä¸ªçš„ "),a("code",[t._v("Watcher")]),t._v(" åœ¨åŒä¸€ä¸ª tick çš„æ—¶å€™åº”è¯¥åªè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´é˜Ÿåˆ— "),a("code",[t._v("queue")]),t._v(" ä¸­ä¸åº”è¯¥å‡ºç°é‡å¤çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ã€‚")]),t._v(" "),a("li",[t._v("é‚£ä¹ˆæˆ‘ä»¬ç»™ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡èµ·ä¸ªåå­—å§ï½ç”¨ "),a("code",[t._v("id")]),t._v(" æ¥æ ‡è®°æ¯ä¸€ä¸ª "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ï¼Œè®©ä»–ä»¬çœ‹èµ·æ¥â€œä¸å¤ªä¸€æ ·â€ã€‚")]),t._v(" "),a("li",[t._v("å®ç° "),a("code",[t._v("update")]),t._v(" æ–¹æ³•ï¼Œåœ¨ä¿®æ”¹æ•°æ®åç”± "),a("code",[t._v("Dep")]),t._v(" æ¥è°ƒç”¨ï¼Œ è€Œ "),a("code",[t._v("run")]),t._v(" æ–¹æ³•æ‰æ˜¯çœŸæ­£çš„è§¦å‘ "),a("code",[t._v("patch")]),t._v(" æ›´æ–°è§†å›¾çš„æ–¹æ³•ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" uid "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("uid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'watch'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("' update'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueWatcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'watch'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'è§†å›¾æ›´æ–°å•¦ï½'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"queuewatcher"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#queuewatcher"}},[t._v("#")]),t._v(" queueWatcher")]),t._v(" "),a("blockquote",[a("p",[t._v("ä¸çŸ¥é“å¤§å®¶æ³¨æ„åˆ°äº†æ²¡æœ‰ï¼Ÿç¬”è€…å·²ç»å°† "),a("code",[t._v("Watcher")]),t._v(" çš„ "),a("code",[t._v("update")]),t._v(" ä¸­çš„å®ç°æ”¹æˆäº†")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueWatcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("å°† "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡è‡ªèº«ä¼ é€’ç»™ "),a("code",[t._v("queueWatcher")]),t._v(" æ–¹æ³•ã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹ "),a("code",[t._v("queueWatcher")]),t._v(" æ–¹æ³•ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" has "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" queue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" waiting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueWatcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("watcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" watcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("has"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        has"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("waiting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            waiting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flushSchedulerQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("ul",[a("li",[t._v("æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå«åš "),a("code",[t._v("has")]),t._v(" çš„ mapï¼Œé‡Œé¢å­˜æ”¾ id -> true ( false ) çš„å½¢å¼ï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦å·²ç»å­˜åœ¨ç›¸åŒçš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ ï¼ˆè¿™æ ·æ¯”æ¯æ¬¡éƒ½å»éå† "),a("code",[t._v("queue")]),t._v(" æ•ˆç‡ä¸Šä¼šé«˜å¾ˆå¤šï¼‰ã€‚")]),t._v(" "),a("li",[t._v("å¦‚æœç›®å‰é˜Ÿåˆ— "),a("code",[t._v("queue")]),t._v(" ä¸­è¿˜æ²¡æœ‰è¿™ä¸ª "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ï¼Œåˆ™è¯¥å¯¹è±¡ä¼šè¢« "),a("code",[t._v("push")]),t._v(" è¿›é˜Ÿåˆ— "),a("code",[t._v("queue")]),t._v(" ä¸­å»ã€‚")]),t._v(" "),a("li",[a("code",[t._v("waiting")]),t._v(" æ˜¯ä¸€ä¸ªæ ‡è®°ä½ï¼Œæ ‡è®°æ˜¯å¦å·²ç»å‘ "),a("code",[t._v("nextTick")]),t._v(" ä¼ é€’äº† "),a("code",[t._v("flushSchedulerQueue")]),t._v(" æ–¹æ³•ï¼Œåœ¨ä¸‹ä¸€ä¸ª tick çš„æ—¶å€™æ‰§è¡Œ "),a("code",[t._v("flushSchedulerQueue")]),t._v(" æ–¹æ³•æ¥ flush é˜Ÿåˆ— "),a("code",[t._v("queue")]),t._v("ï¼Œæ‰§è¡Œå®ƒé‡Œé¢çš„æ‰€æœ‰ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡çš„ "),a("code",[t._v("run")]),t._v(" æ–¹æ³•ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"flushschedulerqueue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flushschedulerqueue"}},[t._v("#")]),t._v(" flushSchedulerQueue")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("flushSchedulerQueue")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" watcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" index"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        watcher "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" watcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        has"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        watcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    waiting  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"ä¸¾ä¸ªä¾‹å­"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸¾ä¸ªä¾‹å­"}},[t._v("#")]),t._v(" ä¸¾ä¸ªä¾‹å­")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" watch1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" watch2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nwatch1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nwatch1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nwatch2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("ul",[a("li",[t._v("æˆ‘ä»¬ç°åœ¨ new äº†ä¸¤ä¸ª "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ï¼Œå› ä¸ºä¿®æ”¹äº† "),a("code",[t._v("data")]),t._v(" çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¨¡æ‹Ÿè§¦å‘äº†ä¸¤æ¬¡ "),a("code",[t._v("watch1")]),t._v(" çš„ "),a("code",[t._v("update")]),t._v(" ä»¥åŠ ä¸€æ¬¡ "),a("code",[t._v("watch2")]),t._v(" çš„ "),a("code",[t._v("update")]),t._v("ã€‚")]),t._v(" "),a("li",[t._v("å‡è®¾æ²¡æœ‰æ‰¹é‡å¼‚æ­¥æ›´æ–°ç­–ç•¥çš„è¯ï¼Œç†è®ºä¸Šåº”è¯¥æ‰§è¡Œ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡çš„ "),a("code",[t._v("run")]),t._v("ï¼Œé‚£ä¹ˆä¼šæ‰“å°ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("watch1 update\nwatch1è§†å›¾æ›´æ–°å•¦ï½\nwatch1 update\nwatch1è§†å›¾æ›´æ–°å•¦ï½\nwatch2 update\nwatch2è§†å›¾æ›´æ–°å•¦ï½\n\n")])])]),a("p",[t._v("å®é™…ä¸Šåˆ™æ‰§è¡Œ")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("watch1 update\nwatch1 update\nwatch2 update\nwatch1è§†å›¾æ›´æ–°å•¦ï½\nwatch2è§†å›¾æ›´æ–°å•¦ï½\n\n")])])]),a("ul",[a("li",[t._v("è¿™å°±æ˜¯å¼‚æ­¥æ›´æ–°ç­–ç•¥çš„æ•ˆæœï¼Œç›¸åŒçš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ä¼šåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­è¢«å‰”é™¤ï¼Œåœ¨ä¸‹ä¸€ä¸ª tick çš„æ—¶å€™å»æ›´æ–°è§†å›¾ï¼Œä»è€Œè¾¾åˆ°å¯¹æˆ‘ä»¬ç¬¬ä¸€ä¸ªä¾‹å­çš„ä¼˜åŒ–ã€‚")]),t._v(" "),a("li",[t._v("æˆ‘ä»¬å†å›è¿‡å¤´èŠä¸€ä¸‹ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œ "),a("code",[t._v("number")]),t._v(" ä¼šè¢«ä¸åœåœ°è¿›è¡Œ "),a("code",[t._v("++")]),t._v(" æ“ä½œï¼Œä¸æ–­åœ°è§¦å‘å®ƒå¯¹åº”çš„ "),a("code",[t._v("Dep")]),t._v(" ä¸­çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡çš„ "),a("code",[t._v("update")]),t._v(" æ–¹æ³•ã€‚ç„¶åæœ€ç»ˆ "),a("code",[t._v("queue")]),t._v(" ä¸­å› ä¸ºå¯¹ç›¸åŒ "),a("code",[t._v("id")]),t._v(" çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡è¿›è¡Œäº†ç­›é€‰ï¼Œä»è€Œ "),a("code",[t._v("queue")]),t._v(" ä¸­å®é™…ä¸Šåªä¼šå­˜åœ¨ä¸€ä¸ª "),a("code",[t._v("number")]),t._v(" å¯¹åº”çš„ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡ã€‚åœ¨ä¸‹ä¸€ä¸ª tick çš„æ—¶å€™ï¼ˆæ­¤æ—¶ "),a("code",[t._v("number")]),t._v(" å·²ç»å˜æˆäº† 1000ï¼‰ï¼Œè§¦å‘ "),a("code",[t._v("Watcher")]),t._v(" å¯¹è±¡çš„ "),a("code",[t._v("run")]),t._v(" æ–¹æ³•æ¥æ›´æ–°è§†å›¾ï¼Œå°†è§†å›¾ä¸Šçš„ "),a("code",[t._v("number")]),t._v(" ä» 0 ç›´æ¥å˜æˆ 1000ã€‚")]),t._v(" "),a("li",[t._v("åˆ°è¿™é‡Œï¼Œæ‰¹é‡å¼‚æ­¥æ›´æ–°ç­–ç•¥åŠ "),a("code",[t._v("nextTick")]),t._v(" åŸç†å·²ç»è®²å®Œäº†ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹ Vuex çŠ¶æ€ç®¡ç†çš„å·¥ä½œåŸç†ã€‚")])]),t._v(" "),a("p",[t._v("æ³¨ï¼šæœ¬èŠ‚ä»£ç å‚è€ƒ"),a("a",{attrs:{href:"https://github.com/answershuto/VueDemo/blob/master/%E3%80%8A%E6%89%B9%E9%87%8F%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0%E7%AD%96%E7%95%A5%E5%8F%8A%20nextTick%20%E5%8E%9F%E7%90%86%E3%80%8B.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€Šæ‰¹é‡å¼‚æ­¥æ›´æ–°ç­–ç•¥åŠ nextTick åŸç†ã€‹"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"å…«ã€vuex-çŠ¶æ€ç®¡ç†çš„å·¥ä½œåŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…«ã€vuex-çŠ¶æ€ç®¡ç†çš„å·¥ä½œåŸç†"}},[t._v("#")]),t._v(" å…«ã€Vuex çŠ¶æ€ç®¡ç†çš„å·¥ä½œåŸç†")]),t._v(" "),a("h3",{attrs:{id:"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-vuex"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-vuex"}},[t._v("#")]),t._v(" ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Vuex")]),t._v(" "),a("blockquote",[a("p",[t._v("å½“æˆ‘ä»¬ä½¿ç”¨ Vue.js æ¥å¼€å‘ä¸€ä¸ªå•é¡µåº”ç”¨æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€äº›ç»„ä»¶é—´å…±äº«çš„æ•°æ®æˆ–çŠ¶æ€ï¼Œæˆ–æ˜¯éœ€è¦é€šè¿‡ props æ·±å±‚ä¼ é€’çš„ä¸€äº›æ•°æ®ã€‚åœ¨åº”ç”¨è§„æ¨¡è¾ƒå°çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ propsã€äº‹ä»¶ç­‰å¸¸ç”¨çš„çˆ¶å­ç»„ä»¶çš„ç»„ä»¶é—´é€šä¿¡æ–¹æ³•ï¼Œæˆ–è€…æ˜¯é€šè¿‡äº‹ä»¶æ€»çº¿æ¥è¿›è¡Œä»»æ„ä¸¤ä¸ªç»„ä»¶çš„é€šä¿¡ã€‚ä½†æ˜¯å½“åº”ç”¨é€æ¸å¤æ‚åï¼Œé—®é¢˜å°±å¼€å§‹å‡ºç°äº†ï¼Œè¿™æ ·çš„é€šä¿¡æ–¹å¼ä¼šå¯¼è‡´æ•°æ®æµå¼‚å¸¸åœ°æ··ä¹±ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2020/07/vue/27.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°æˆ‘ä»¬çš„çŠ¶æ€ç®¡ç†å·¥å…· Vuex äº†ã€‚Vuex æ˜¯ä¸€ä¸ªä¸“é—¨ä¸º Vue.js æ¡†æ¶è®¾è®¡çš„ã€ä¸“é—¨ç”¨æ¥å¯¹äº Vue.js åº”ç”¨è¿›è¡ŒçŠ¶æ€ç®¡ç†çš„åº“ã€‚å®ƒå€Ÿé‰´äº† Fluxã€redux çš„åŸºæœ¬æ€æƒ³ï¼Œå°†çŠ¶æ€æŠ½ç¦»åˆ°å…¨å±€ï¼Œå½¢æˆä¸€ä¸ª Storeã€‚å› ä¸º Vuex å†…éƒ¨é‡‡ç”¨äº† new Vue æ¥å°† Store å†…çš„æ•°æ®è¿›è¡Œã€Œå“åº”å¼åŒ–ã€ï¼Œæ‰€ä»¥ Vuex æ˜¯ä¸€æ¬¾åˆ©ç”¨ Vue å†…éƒ¨æœºåˆ¶çš„åº“ï¼Œä¸ Vue é«˜åº¦å¥‘åˆï¼Œä¸ Vue æ­é…ä½¿ç”¨æ˜¾å¾—æ›´åŠ ç®€å•é«˜æ•ˆï¼Œä½†ç¼ºç‚¹æ˜¯ä¸èƒ½ä¸å…¶ä»–çš„æ¡†æ¶ï¼ˆå¦‚ reactï¼‰é…åˆä½¿ç”¨ã€‚")])]),t._v(" "),a("p",[t._v("æœ¬èŠ‚å°†ç®€å•ä»‹ç» Vuex æœ€æ ¸å¿ƒçš„å†…éƒ¨æœºåˆ¶ï¼Œèµ·ä¸ªæŠ›ç –å¼•ç‰çš„ä½œç”¨ï¼Œæƒ³äº†è§£æ›´å¤šç»†èŠ‚å¯ä»¥å‚è€ƒç¬”è€… "),a("a",{attrs:{href:"https://github.com/answershuto",target:"_blank",rel:"noopener noreferrer"}},[t._v("Github"),a("OutboundLink")],1),t._v(" ä¸Šçš„å¦ä¸€ç¯‡æ–‡ç«  "),a("a",{attrs:{href:"https://github.com/answershuto/learnVue/blob/master/docs/Vuex%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.MarkDown",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€ŠVuexæºç è§£æã€‹"),a("OutboundLink")],1),t._v("æˆ–è€…ç›´æ¥é˜…è¯» "),a("a",{attrs:{href:"https://github.com/vuejs/vuex",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vuexæºç "),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("h3",{attrs:{id:"å®‰è£…"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…"}},[t._v("#")]),t._v(" å®‰è£…")]),t._v(" "),a("blockquote",[a("p",[t._v("Vue.js æä¾›äº†ä¸€ä¸ª "),a("code",[t._v("Vue.use")]),t._v(" çš„æ–¹æ³•æ¥å®‰è£…æ’ä»¶ï¼Œå†…éƒ¨ä¼šè°ƒç”¨æ’ä»¶æä¾›çš„ "),a("code",[t._v("install")]),t._v(" æ–¹æ³•ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Vue.use(Vuex);\n\n")])])]),a("blockquote",[a("p",[t._v("æ‰€ä»¥æˆ‘ä»¬çš„æ’ä»¶éœ€è¦æä¾›ä¸€ä¸ª "),a("code",[t._v("install")]),t._v(" æ–¹æ³•æ¥å®‰è£…ã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("let Vue;\n\nexport default install (_Vue) {\n    Vue.mixin({ beforeCreate: vuexInit });\n    Vue = _Vue;\n}\n\n")])])]),a("blockquote",[a("p",[t._v("æˆ‘ä»¬é‡‡ç”¨ "),a("code",[t._v("Vue.mixin")]),t._v(" æ–¹æ³•å°† "),a("code",[t._v("vuexInit")]),t._v(" æ–¹æ³•æ··æ·†è¿› "),a("code",[t._v("beforeCreate")]),t._v(" é’©å­ä¸­ï¼Œå¹¶ç”¨ "),a("code",[t._v("Vue")]),t._v(" ä¿å­˜ Vue å¯¹è±¡ã€‚é‚£ä¹ˆ "),a("code",[t._v("vuexInit")]),t._v(" ç©¶ç«Ÿå®ç°äº†ä»€ä¹ˆå‘¢ï¼Ÿ")])]),t._v(" "),a("p",[t._v("æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ä½¿ç”¨ Vuex çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°† "),a("code",[t._v("store")]),t._v(" ä¼ å…¥åˆ° Vue å®ä¾‹ä¸­å»ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("/*å°†storeæ”¾å…¥Vueåˆ›å»ºæ—¶çš„optionä¸­*/\nnew Vue({\n    el: '#app',\n    store\n});\n\n")])])]),a("blockquote",[a("p",[t._v("ä½†æ˜¯æˆ‘ä»¬å´åœ¨æ¯ä¸€ä¸ª vm ä¸­éƒ½å¯ä»¥è®¿é—®è¯¥ "),a("code",[t._v("store")]),t._v("ï¼Œè¿™ä¸ªå°±éœ€è¦é  "),a("code",[t._v("vuexInit")]),t._v(" äº†ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vuexInit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("ul",[a("li",[t._v("å› ä¸ºä¹‹å‰å·²ç»ç”¨"),a("code",[t._v("Vue.mixin")]),t._v(" æ–¹æ³•å°† "),a("code",[t._v("vuexInit")]),t._v(" æ–¹æ³•æ··æ·†è¿› "),a("code",[t._v("beforeCreate")]),t._v(" é’©å­ä¸­ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ª vm å®ä¾‹éƒ½ä¼šè°ƒç”¨ "),a("code",[t._v("vuexInit")]),t._v(" æ–¹æ³•ã€‚")]),t._v(" "),a("li",[t._v("å¦‚æœæ˜¯æ ¹èŠ‚ç‚¹ï¼ˆ"),a("code",[t._v("$options")]),t._v("ä¸­å­˜åœ¨ "),a("code",[t._v("store")]),t._v(" è¯´æ˜æ˜¯æ ¹èŠ‚ç‚¹ï¼‰ï¼Œåˆ™ç›´æ¥å°† "),a("code",[t._v("options.store")]),t._v(" èµ‹å€¼ç»™ "),a("code",[t._v("this.$store")]),t._v("ã€‚å¦åˆ™åˆ™è¯´æ˜ä¸æ˜¯æ ¹èŠ‚ç‚¹ï¼Œä»çˆ¶èŠ‚ç‚¹çš„ "),a("code",[t._v("$store")]),t._v(" ä¸­è·å–ã€‚")])]),t._v(" "),a("p",[t._v("é€šè¿‡è¿™æ­¥çš„æ“ä½œï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥åœ¨ä»»æ„ä¸€ä¸ª vm ä¸­é€šè¿‡ "),a("code",[t._v("this.$store")]),t._v(" æ¥è®¿é—® "),a("code",[t._v("Store")]),t._v(" çš„å®ä¾‹å•¦ï½")]),t._v(" "),a("h3",{attrs:{id:"store"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#store"}},[t._v("#")]),t._v(" Store")]),t._v(" "),a("p",[a("strong",[t._v("1. æ•°æ®çš„å“åº”å¼åŒ–")])]),t._v(" "),a("blockquote",[a("p",[t._v("é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨ "),a("code",[t._v("Store")]),t._v(" çš„æ„é€ å‡½æ•°ä¸­å¯¹ "),a("code",[t._v("state")]),t._v(" è¿›è¡Œã€Œå“åº”å¼åŒ–ã€ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_vm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            $$state"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("ç†Ÿæ‚‰ã€Œå“åº”å¼ã€çš„åŒå­¦è‚¯å®šçŸ¥é“ï¼Œè¿™ä¸ªæ­¥éª¤ä»¥åï¼Œ"),a("code",[t._v("state")]),t._v(" ä¼šå°†éœ€è¦çš„ä¾èµ–æ”¶é›†åœ¨ "),a("code",[t._v("Dep")]),t._v(" ä¸­ï¼Œåœ¨è¢«ä¿®æ”¹æ—¶æ›´æ–°å¯¹åº”è§†å›¾ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå°ä¾‹å­ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" globalData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    d"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            $$state"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                globalData\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* modify */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    globalData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hi~'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("globalData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" globalData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("ä»»æ„æ¨¡æ¿ä¸­")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("<div>{{globalData.d}}</div>\n\n")])])]),a("blockquote",[a("p",[t._v("ä¸Šè¿°ä»£ç åœ¨å…¨å±€æœ‰ä¸€ä¸ª "),a("code",[t._v("globalData")]),t._v("ï¼Œå®ƒè¢«ä¼ å…¥ä¸€ä¸ª "),a("code",[t._v("Vue")]),t._v(" å¯¹è±¡çš„ "),a("code",[t._v("data")]),t._v(" ä¸­ï¼Œä¹‹ååœ¨ä»»æ„ Vue æ¨¡æ¿ä¸­å¯¹è¯¥å˜é‡è¿›è¡Œå±•ç¤ºï¼Œå› ä¸ºæ­¤æ—¶ "),a("code",[t._v("globalData")]),t._v(" å·²ç»åœ¨ Vue çš„ "),a("code",[t._v("prototype")]),t._v(" ä¸Šäº†æ‰€ä»¥ç›´æ¥é€šè¿‡ "),a("code",[t._v("this.prototype")]),t._v(" è®¿é—®ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¨¡æ¿ä¸­çš„ "),a("code",[t._v("{globalData.d}")]),t._v("ã€‚æ­¤æ—¶ï¼Œ"),a("code",[t._v("setTimeout")]),t._v(" åœ¨ 1s ä¹‹åå°† "),a("code",[t._v("globalData.d")]),t._v(" è¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬å‘ç°æ¨¡æ¿ä¸­çš„ "),a("code",[t._v("globalData.d")]),t._v(" å‘ç”Ÿäº†å˜åŒ–ã€‚å…¶å®ä¸Šè¿°éƒ¨åˆ†å°±æ˜¯ Vuex ä¾èµ– Vue æ ¸å¿ƒå®ç°æ•°æ®çš„â€œå“åº”å¼åŒ–â€ã€‚")])]),t._v(" "),a("p",[t._v("è®²å®Œäº† Vuex æœ€æ ¸å¿ƒçš„é€šè¿‡ Vue è¿›è¡Œæ•°æ®çš„ã€Œå“åº”å¼åŒ–ã€ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥ä»‹ç»ä¸¤ä¸ª "),a("code",[t._v("Store")]),t._v(" çš„ APIã€‚")]),t._v(" "),a("p",[a("strong",[t._v("2. commit")])]),t._v(" "),a("blockquote",[a("p",[t._v("é¦–å…ˆæ˜¯ "),a("code",[t._v("commit")]),t._v(" æ–¹æ³•ï¼Œæˆ‘ä»¬çŸ¥é“ "),a("code",[t._v("commit")]),t._v(" æ–¹æ³•æ˜¯ç”¨æ¥è§¦å‘ "),a("code",[t._v("mutation")]),t._v(" çš„ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" entry "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_mutations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    entry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitIterator")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("ä» "),a("code",[t._v("_mutations")]),t._v(" ä¸­å–å‡ºå¯¹åº”çš„ mutationï¼Œå¾ªç¯æ‰§è¡Œå…¶ä¸­çš„æ¯ä¸€ä¸ª mutationã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("3. dispatch")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("dispatch")]),t._v(" åŒæ ·é“ç†ï¼Œç”¨äºè§¦å‘ actionï¼Œå¯ä»¥åŒ…å«å¼‚æ­¥çŠ¶æ€ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" payload")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" entry "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_actions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" entry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("handler")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" entry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("blockquote",[a("p",[t._v("åŒæ ·çš„ï¼Œå–å‡º "),a("code",[t._v("_actions")]),t._v(" ä¸­çš„æ‰€æœ‰å¯¹åº” "),a("code",[t._v("action")]),t._v("ï¼Œå°†å…¶æ‰§è¡Œï¼Œå¦‚æœæœ‰å¤šä¸ªåˆ™ç”¨ "),a("code",[t._v("Promise.all")]),t._v(" è¿›è¡ŒåŒ…è£…ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"æœ€å"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æœ€å"}},[t._v("#")]),t._v(" æœ€å")]),t._v(" "),a("blockquote",[a("p",[t._v("ç†è§£ Vuex çš„æ ¸å¿ƒåœ¨äºç†è§£å…¶å¦‚ä½•ä¸ Vue æœ¬èº«ç»“åˆï¼Œå¦‚ä½•åˆ©ç”¨ Vue çš„å“åº”å¼æœºåˆ¶æ¥å®ç°æ ¸å¿ƒ Store çš„ã€Œå“åº”å¼åŒ–ã€ã€‚")])]),t._v(" "),a("p",[t._v("Vuex æœ¬èº«ä»£ç ä¸å¤šä¸”è®¾è®¡ä¼˜é›…ï¼Œéå¸¸å€¼å¾—ä¸€è¯»ï¼Œæƒ³é˜…è¯»æºç çš„åŒå­¦è¯·çœ‹"),a("a",{attrs:{href:"https://github.com/vuejs/vuex",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vuexæºç "),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("p",[t._v("æ³¨ï¼šæœ¬èŠ‚ä»£ç å‚è€ƒ"),a("a",{attrs:{href:"https://github.com/answershuto/VueDemo/blob/master/%E3%80%8AVuex%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E3%80%8B.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€ŠVuexçŠ¶æ€ç®¡ç†çš„å·¥ä½œåŸç†ã€‹"),a("OutboundLink")],1),t._v("ã€‚")])])}),[],!1,null,null,null);s.default=p.exports}}]);